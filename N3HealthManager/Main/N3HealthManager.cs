using EMKService;
using MatrixN3HealthManager.DTOs;
using MatrixN3HealthManager.Models;
using Newtonsoft.Json;
using PixService;
using System.Net;

namespace MatrixN3HealthManager.Main
{
    public class N3HealthManager : IN3HealthService
    {
        private readonly PixServiceClient pixClient;
        private readonly EmkServiceClient emkClient;
        private readonly string projectGuid = "7e201716-0943-48c9-88d0-6ddd7b1553aa";
        private readonly string idLPU = "95f617cf-4747-4285-9681-4a875357df26";

        public N3HealthManager()
        {
            pixClient = new PixServiceClient(PixServiceClient.EndpointConfiguration.BasicHttpBinding_IPixService);
            emkClient = new EmkServiceClient(EmkServiceClient.EndpointConfiguration.BasicHttpBinding_IEmkService);
        }

        public async Task<BaseResponse> AddPatientAndGetId(AddPatientRequestDto dto)
        {
            try
            {
                var existingPatient = await pixClient.GetPatientByGlobalIdAsync(dto.ProjectGuid, dto.PatientGlobalId, dto.IdLpu);

                var patientDto = dto.Patient;

                var patient = new PatientDto
                {
                    FamilyName = patientDto.FamilyName,
                    GivenName = patientDto.GivenName,
                    MiddleName = patientDto.MiddleName,
                    BirthDate = patientDto.BirthDate,
                    Sex = (byte)patientDto.Sex,
                    IdPatientMIS = existingPatient != null ? existingPatient.IdPatientMIS : null,
                    IdGlobal = dto.PatientGlobalId,
                    BirthPlace = new BirthPlaceDto
                    {
                        City = patientDto.BirthPlace.City,
                        Region = patientDto.BirthPlace.Region,
                        Country = patientDto.BirthPlace.Country
                    },
                    Addresses = patientDto.Addresses.Select(a => new AddressDto
                    {
                        Street = a.Street,
                        Building = a.Building,
                        Appartment = a.Appartment,
                        City = a.City,
                        PostalCode = a.PostalCode,
                        StringAddress = a.StringAddress,
                        IdAddressType = (byte)a.AddressType
                    }).ToArray(),
                    Contacts = patientDto.Contacts.Select(c => new ContactDto
                    {
                        ContactValue = c.ContactValue,
                        IdContactType = (byte)c.ContactType
                    }).ToArray(),
                    Documents = patientDto.Documents.Select(d => new DocumentDto
                    {
                        DocN = d.DocN,
                        DocS = d.DocS,
                        ProviderName = d.ProviderName,
                        RegionCode = d.RegionCode,
                        IdDocumentType = (short)d.DocumentType
                    }).ToArray()
                };


                return new BaseResponse(
                    HttpStatusCode.OK,
                    existingPatient != null
                        ? await pixClient.AddPatientAndGetIdAsync(dto.ProjectGuid, dto.IdLpu, patient)
                        : await pixClient.UpdatePatientAndGetIdAsync(dto.ProjectGuid, dto.IdLpu, patient)
                );

            }
            catch (Exception ex)
            {
                return new BaseResponse(HttpStatusCode.BadRequest, ExceptionStatus.error, ex.Message);
            }
        }
        public async Task<BaseResponse> GetPatient()
        {
            PatientDto patientDto = new()
            {
                IdPatientMIS = "patient3" //bizdeki idsi
            };

            var result = await pixClient.GetPatientAsync(projectGuid, idLPU, patientDto, SourceType.Fed);

            return new BaseResponse(HttpStatusCode.OK, result);
        }
        public async Task<BaseResponse> GetPatientByGlobalId(string patientId)
        {
            try
            {
                var patient = await pixClient.GetPatientByGlobalIdAsync(projectGuid, "98dfe41e-a22b-4838-b61a-f076e0809f23/", idLPU);
                return new BaseResponse(HttpStatusCode.OK, patient);
            }
            catch (Exception ex)
            {
                if (ex.Message == "The creator of this fault did not specify a Reason.")
                    return new BaseResponse(HttpStatusCode.BadRequest, ExceptionStatus.error, ex.Message);

                throw new Exception("An error occurred while fetching the patient by global ID.", ex);
            }
        }
        public async Task<BaseResponse> UpdatePatientAndGetId()
        {
            PatientDto patientDto = new()
            {
                FamilyName = "Te",
                GivenName = "Sakoc",
                MiddleName = "Sakoci",
                BirthDate = new DateTime(1987, 1, 10, 10, 38, 1),
                Sex = (byte)N3Enums.N3Sex.Male,
                IdPatientMIS = "patient5ssq",
                Contacts = [
                        new(){
                            ContactValue = "+76969696969",
                            IdContactType = 2
                        }
                    ],
                IdGlobal = "5bb3d57f-6203-43eb-b289-2cfb0a51409e"
            };
            var result = await pixClient.UpdatePatientAndGetIdAsync(projectGuid, idLPU, patientDto);

            return new BaseResponse(HttpStatusCode.OK, result);
        }
        public async Task<BaseResponse> AddMedRecord(MedDocumentCreateDto dto)
        {
            try
            {

                PatientDto findingPatient = new()
                {
                    IdPatientMIS = dto.PatientGlobalId
                };

                var patients = await pixClient.GetPatientAsync(dto.ProjectGuid, dto.Idlpu, findingPatient, SourceType.Fed);
                if (patients == null)
                    return new BaseResponse(HttpStatusCode.BadRequest, ExceptionStatus.error, "Patient not found");

                var existingPatient = patients.FirstOrDefault(x => x.IdPatientMIS == dto.PatientGlobalId);
                if (existingPatient == null)
                {
                    var patientDto = dto.Patient.Patient;
                    var patient = new PatientDto
                    {
                        FamilyName = patientDto.FamilyName,
                        GivenName = patientDto.GivenName,
                        MiddleName = patientDto.MiddleName,
                        BirthDate = patientDto.BirthDate,
                        Sex = (byte)patientDto.Sex,
                        IdPatientMIS = findingPatient.IdPatientMIS,
                        IdGlobal = dto.PatientGlobalId,
                        BirthPlace = new BirthPlaceDto
                        {
                            City = patientDto.BirthPlace.City,
                            Region = patientDto.BirthPlace.Region,
                            Country = patientDto.BirthPlace.Country
                        },
                        Addresses = patientDto.Addresses.Select(a => new AddressDto
                        {
                            Street = a.Street,
                            Building = a.Building,
                            Appartment = a.Appartment,
                            City = a.City,
                            PostalCode = a.PostalCode,
                            StringAddress = a.StringAddress,
                            IdAddressType = (byte)a.AddressType
                        }).ToArray(),
                        Contacts = patientDto.Contacts.Select(c => new ContactDto
                        {
                            ContactValue = c.ContactValue,
                            IdContactType = (byte)c.ContactType
                        }).ToArray(),
                        Documents = patientDto.Documents.Select(d => new DocumentDto
                        {
                            DocN = d.DocN,
                            DocS = d.DocS,
                            ProviderName = d.ProviderName,
                            RegionCode = d.RegionCode,
                            IdDocumentType = (short)d.DocumentType,
                            IssuedDate = d.IssuedDate,
                        }).ToArray()
                    };




                    var patientCreateDto = await pixClient.AddPatientAndGetIdAsync(dto.ProjectGuid, dto.Idlpu, patient);
                }
                else
                {
                    var patientDto = dto.Patient.Patient;

                    // Prefer a stable MIS id from existing patient record.
                    // If your "patients" list stores IdPatientMIS differently, adjust accordingly.
                    var updatePatient = new PatientDto
                    {
                        FamilyName = patientDto.FamilyName,
                        GivenName = patientDto.GivenName,
                        MiddleName = patientDto.MiddleName,
                        BirthDate = patientDto.BirthDate,
                        Sex = (byte)patientDto.Sex,

                        // Use the known MIS identifier for update.
                        // You can also fallback to findingPatient.IdPatientMIS if your flow requires it.
                        IdPatientMIS = existingPatient.IdPatientMIS,

                        IdGlobal = dto.PatientGlobalId,

                        BirthPlace = patientDto.BirthPlace == null ? null : new BirthPlaceDto
                        {
                            City = patientDto.BirthPlace.City,
                            Region = patientDto.BirthPlace.Region,
                            Country = patientDto.BirthPlace.Country
                        },

                        Addresses = patientDto.Addresses?
                            .Select(a => new AddressDto
                            {
                                Street = a.Street,
                                Building = a.Building,
                                Appartment = a.Appartment,
                                City = a.City,
                                PostalCode = a.PostalCode,
                                StringAddress = a.StringAddress,
                                IdAddressType = (byte)a.AddressType
                            })
                            .ToArray()
                            ?? Array.Empty<AddressDto>(),

                        Contacts = patientDto.Contacts?
                            .Select(c => new ContactDto
                            {
                                ContactValue = c.ContactValue,
                                IdContactType = (byte)c.ContactType
                            })
                            .ToArray()
                            ?? Array.Empty<ContactDto>(),

                        // This is likely the critical part for your SNILS issue:
                        // Always push the current documents set from dto.
                        Documents = patientDto.Documents?
                            .Select(d => new DocumentDto
                            {
                                DocN = d.DocN,
                                //DocS = d.DocS,
                                ProviderName = d.ProviderName,
                                //RegionCode = d.RegionCode,
                                IdDocumentType = (short)d.DocumentType,
                                IssuedDate = d.IssuedDate,
                            })
                            .ToArray()
                            ?? Array.Empty<DocumentDto>()
                    };

                    string json = JsonConvert.SerializeObject(updatePatient);

                    var updatedId =
                        await pixClient.UpdatePatientAndGetIdAsync(dto.ProjectGuid, dto.Idlpu, updatePatient);

                }

                var xmlBytes = Convert.FromBase64String("PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPENsaW5pY2FsRG9jdW1lbnQgeG1sbnM9InVybjpobDctb3JnOnYzIiB4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIiB4bWxuczppZGVudGl0eT0idXJuOmhsNy1ydTppZGVudGl0eSIgeG1sbnM6YWRkcmVzcz0idXJuOmhsNy1ydTphZGRyZXNzIiB4bWxuczptZWRTZXJ2aWNlPSJ1cm46aGw3LXJ1Om1lZFNlcnZpY2UiIHhtbG5zOmZpYXM9InVybjpobDctcnU6ZmlhcyI+Cgk8IS0tIFIgWzEuLl0g0KLRgNC10LHRg9C10LzRi9C5INGN0LvQtdC80LXQvdGCLiDQrdC70LXQvNC10L3RgiDQvtCx0Y/Qt9Cw0L0g0LjQvNC10YLRjCDQvdC10L/Rg9GB0YLQvtC1INC90LDQv9C+0LvQvdC10L3QuNC1LCBudWxsRmxhdm9yINC90LUg0YDQsNC30YDQtdGI0ZHQvSAtLT4KCTwhLS0gWzEuLl0g0J7QsdGP0LfQsNGC0LXQu9GM0L3Ri9C5INGN0LvQtdC80LXQvdGCLiDQrdC70LXQvNC10L3RgiDQvtCx0Y/Qt9Cw0L0g0L/RgNC40YHRg9GC0YHRgtCy0L7QstCw0YLRjCwg0L3QviDQvNC+0LbQtdGCINC40LzQtdGC0Ywg0L/Rg9GB0YLQvtC1INC90LDQv9C+0LvQvdC10L3QuNC1INGBINGD0LrQsNC30LDQvdC40LXQvCDQv9GA0LjRh9C40L3RiyDQvtGC0YHRg9GC0YHRgtCy0LjRjyDQuNC90YTQvtGA0LzQsNGG0LjQuCDRh9C10YDQtdC3IG51bGxGbGF2b3IgLS0+Cgk8IS0tIFswLi5dINCd0LUg0L7QsdGP0LfQsNGC0LXQu9GM0L3Ri9C5INGN0LvQtdC80LXQvdGCLiDQrdC70LXQvNC10L3RgiDQvNC+0LbQtdGCINC+0YLRgdGD0YLRgdGC0LLQvtCy0LDRgtGMLiDQldGB0LvQuCDRjdC70LXQvNC10L3RgiDQv9GA0LXQtNGB0YLQsNCy0LvQtdC9LCDRgtC+IG51bGxGbGF2b3Ig0L3QtSDRgNCw0LfRgNC10YjRkdC9IC0tPgoJPCEtLSBSIFsxLi4xXSDQo9C60LDQt9Cw0L3QuNC1INC90LAg0L7QsdC70LDRgdGC0Ywg0L/RgNC40LzQtdC90LXQvdC40Y8g0LTQvtC60YPQvNC10L3RgtCwICjQoNCkKSAtLT4KCTxyZWFsbUNvZGUgY29kZT0iUlUiIC8+Cgk8IS0tIFIgWzEuLjFdINCj0LrQsNC30LDQvdC40LUg0L3QsCDRgtC40L8g0YHRgtGA0YPQutGC0YPRgNGLINC00L7QutGD0LzQtdC90YLQsCAoQ0RBIFIyKSAtLT4KCTx0eXBlSWQgcm9vdD0iMi4xNi44NDAuMS4xMTM4ODMuMS4zIiBleHRlbnNpb249IlBPQ0RfTVQwMDAwNDAiIC8+Cgk8IS0tIFIgWzEuLjFdINCj0L3QuNC60LDQu9GM0L3Ri9C5INC40LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINGA0YPQutC+0LLQvtC00YHRgtCy0LAg0L/QviDRgNC10LDQu9C40LfQsNGG0LjQuCDQodCt0JzQlCAtLT4KCTx0ZW1wbGF0ZUlkIHJvb3Q9IjEuMi42NDMuNS4xLjEzLjEzLjE1LjEzLjUiIC8+Cgk8IS0tIFIgWzEuLjFdINCj0L3QuNC60LDQu9GM0L3Ri9C5INC40LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINC00L7QutGD0LzQtdC90YLQsCDQsiDQnNCY0KEgLS0+Cgk8aWQgcm9vdD0iMS4yLjY0My41LjEuMTMuMTMuMTIuMi43Ny43ODMxLjEwMC4xLjEuNTEiIGV4dGVuc2lvbj0iMTQ0NjMyIiAvPgoJPCEtLSBSIFsxLi4xXSDQktC40LQg0LzQtdC00LjRhtC40L3RgdC60L7Qs9C+INC00L7QutGD0LzQtdC90YLQsCAtLT4KCTxjb2RlIGNvZGU9IjIyNyIgY29kZVN5c3RlbT0iMS4yLjY0My41LjEuMTMuMTMuMTEuMTUyMCIgY29kZVN5c3RlbU5hbWU9ItCt0LvQtdC60YLRgNC+0L3QvdGL0LUg0LzQtdC00LjRhtC40L3RgdC60LjQtSDQtNC+0LrRg9C80LXQvdGC0YsiIGRpc3BsYXlOYW1lPSLQn9GA0L7RgtC+0LrQvtC7INC60L7QvdGB0YPQu9GM0YLQsNGG0LjQuCAoQ0RBKSDQoNC10LTQsNC60YbQuNGPIDUiIGNvZGVTeXN0ZW1WZXJzaW9uPSIxMi4zNCI+CgkJPCEtLSBSIFsxLi4xXSDQktC40LQg0YHRgtGA0YPQutGC0YPRgNC40YDQvtCy0LDQvdC90L7Qs9C+INGN0LvQtdC60YLRgNC+0L3QvdC+0LPQviDQvNC10LTQuNGG0LjQvdGB0LrQvtCz0L4g0LTQvtC60YPQvNC10L3RgtCwIC0tPgoJCTx0cmFuc2xhdGlvbiBjb2RlPSIxMyIgY29kZVN5c3RlbT0iMS4yLjY0My41LjEuMTMuMTMuOTkuMi4xMDc5IiBjb2RlU3lzdGVtTmFtZT0i0JLQuNC00Ysg0YHRgtGA0YPQutGC0YPRgNC40YDQvtCy0LDQvdC90YvRhSDRjdC70LXQutGC0YDQvtC90L3Ri9GFINC80LXQtNC40YbQuNC90YHQutC40YUg0LTQvtC60YPQvNC10L3RgtC+0LIiIGRpc3BsYXlOYW1lPSLQn9GA0L7RgtC+0LrQvtC7INC60L7QvdGB0YPQu9GM0YLQsNGG0LjQuCIgY29kZVN5c3RlbVZlcnNpb249IjEuMTciIC8+Cgk8L2NvZGU+Cgk8IS0tIFIgWzEuLjFdINCX0LDQs9C+0LvQvtCy0L7QuiDQtNC+0LrRg9C80LXQvdGC0LAgLS0+Cgk8dGl0bGU+0J/RgNC+0YLQvtC60L7QuyDQutC+0L3RgdGD0LvRjNGC0LDRhtC40Lg8L3RpdGxlPgoJPCEtLSBbMS4uMV0g0JTQsNGC0LAg0Lgg0LLRgNC10LzRjyDRgdC+0LfQtNCw0L3QuNGPINC00L7QutGD0LzQtdC90YLQsCAtLT4KCTxlZmZlY3RpdmVUaW1lIG51bGxGbGF2b3I9Ik5BIiAvPgoJPCEtLSBSIFsxLi4xXSDQo9GA0L7QstC10L3RjCDQutC+0L3RhNC40LTQtdC90YbQuNCw0LvRjNC90L7RgdGC0Lgg0LTQvtC60YPQvNC10L3RgtCwIC0tPgoJPGNvbmZpZGVudGlhbGl0eUNvZGUgY29kZT0iTiIgY29kZVN5c3RlbT0iMS4yLjY0My41LjEuMTMuMTMuOTkuMi4yODUiIGNvZGVTeXN0ZW1OYW1lPSLQo9GA0L7QstC10L3RjCDQutC+0L3RhNC40LTQtdC90YbQuNCw0LvRjNC90L7RgdGC0Lgg0LzQtdC00LjRhtC40L3RgdC60L7Qs9C+INC00L7QutGD0LzQtdC90YLQsCIgZGlzcGxheU5hbWU9ItCe0LHRi9GH0L3Ri9C5IiBjb2RlU3lzdGVtVmVyc2lvbj0iMS4yIiAvPgoJPCEtLSBSIFsxLi4xXSDQo9C60LDQt9Cw0L3QuNC1INC90LAg0Y/Qt9GL0Log0LTQvtC60YPQvNC10L3RgtCwIC0tPgoJPGxhbmd1YWdlQ29kZSBjb2RlPSJydS1SVSIgLz4KCTwhLS0gUiBbMS4uMV0g0KPQvdC40LrQsNC70YzQvdGL0Lkg0LjQtNC10L3RgtC40YTQuNC60LDRgtC+0YAg0L3QsNCx0L7RgNCwINCy0LXRgNGB0LjQuSDQtNC+0LrRg9C80LXQvdGC0LAgLS0+Cgk8c2V0SWQgcm9vdD0iMS4yLjY0My41LjEuMTMuMTMuMTIuMi43Ny43ODMxLjEwMC4xLjEuNTAiIGV4dGVuc2lvbj0iMTYzNzI1IiAvPgoJPCEtLSBSIFsxLi4xXSDQndC+0LzQtdGAINCy0LXRgNGB0LjQuCDQtNC+0LrRg9C80LXQvdGC0LAgLS0+Cgk8dmVyc2lvbk51bWJlciB2YWx1ZT0iMSIgLz4KCTwhLS0gUiBbMS4uMV0g0KHQstC10LTQtdC90LjRjyDQviDQv9Cw0YbQuNC10L3RgtC1IC0tPgoJPHJlY29yZFRhcmdldD4KCQk8IS0tIFIgWzEuLjFdLS0+CgkJPHBhdGllbnRSb2xlPgoJCQk8IS0tIFIgWzEuLjFdINCj0L3QuNC60LDQu9GM0L3Ri9C5INC40LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINC/0LDRhtC40LXQvdGC0LAg0LIg0JzQmNChIC0tPgoJCQk8aWQgcm9vdD0iMS4yLjY0My41LjEuMTMuMTMuMTIuMi43Ny43ODMxLjEwMC4xLjEuMTAiIGV4dGVuc2lvbj0iNzM1NDg2IiAvPgoJCQk8IS0tIFsxLi4xXSDQodCd0JjQm9ChINC/0LDRhtC40LXQvdGC0LAgLS0+CgkJCTxpZCByb290PSIxLjIuNjQzLjEwMC4zIiBleHRlbnNpb249Ijk4MTU5NzQ0Mjc1IiAvPgoJCQk8IS0tIFsxLi4xXSDQodCy0LXQtNC10L3QuNGPINC+INC00L7QutGD0LzQtdC90YLQtSwg0YPQtNC+0YHRgtC+0LLQtdGA0Y/RjtGJ0LXQvCDQu9C40YfQvdC+0YHRgtGMINC/0LDRhtC40LXQvdGC0LAgLS0+CgkJCTxpZGVudGl0eTpJZGVudGl0eURvYz4KCQkJCTwhLS0gUiBbMS4uMV0g0KLQuNC/INC00L7QutGD0LzQtdC90YLQsCAtLT4KCQkJCTxpZGVudGl0eTpJZGVudGl0eUNhcmRUeXBlIGNvZGU9IjIyMyIgY29kZVN5c3RlbT0iMS4yLjY0My41LjEuMTMuMTMuOTkuMi40OCIgY29kZVN5c3RlbU5hbWU9ItCU0L7QutGD0LzQtdC90YLRiywg0YPQtNC+0YHRgtC+0LLQtdGA0Y/RjtGJ0LjQtSDQu9C40YfQvdC+0YHRgtGMIiBkaXNwbGF5TmFtZT0i0KHQndCY0JvQoSIgY29kZVN5c3RlbVZlcnNpb249IjcuMiIgLz4KCQkJCTwhLS0gWzEuLjFdINCh0LXRgNC40Y8g0LTQvtC60YPQvNC10L3RgtCwIC0tPgoJCQkJPGlkZW50aXR5OlNlcmllcz48L2lkZW50aXR5OlNlcmllcz4KCQkJCTwhLS0gUiBbMS4uMV0g0J3QvtC80LXRgCDQtNC+0LrRg9C80LXQvdGC0LAgLS0+CgkJCQk8aWRlbnRpdHk6TnVtYmVyPjk4MTU5NzQ0Mjc1PC9pZGVudGl0eTpOdW1iZXI+CgkJCQk8IS0tIFsxLi4xXSDQodCy0LXQtNC10L3QuNGPINC+INGC0L7QvCwg0LrQtdC8INCy0YvQtNCw0L0g0LTQvtC60YPQvNC10L3RgiAtLT4KCQkJCTxpZGVudGl0eTpJc3N1ZU9yZ05hbWU+0J7QktCUICLQotCy0LDRgNC00L7QstGB0LrQvtC1IiDQntCj0KTQnNChINCg0L7RgdGB0LjQuCDQv9C+INCz0L7RgC4g0JzQvtGB0LrQstC1PC9pZGVudGl0eTpJc3N1ZU9yZ05hbWU+CgkJCQk8IS0tIFsxLi4xXSDQodCy0LXQtNC10L3QuNGPINC+INGC0L7QvCwg0LrQtdC8INCy0YvQtNCw0L0g0LTQvtC60YPQvNC10L3RgiAo0LrQvtC0INC/0L7QtNGA0LDQt9C00LXQu9C10L3QuNGPKSAtLT4KCQkJCTxpZGVudGl0eTpJc3N1ZU9yZ0NvZGU+PC9pZGVudGl0eTpJc3N1ZU9yZ0NvZGU+CgkJCQk8IS0tIFIgWzEuLjFdINCU0LDRgtCwINCy0YvQtNCw0YfQuCDQtNC+0LrRg9C80LXQvdGC0LAgLS0+CgkJCQk8aWRlbnRpdHk6SXNzdWVEYXRlIHZhbHVlPSIyMDI0MDgxNCIgLz4KCQkJPC9pZGVudGl0eTpJZGVudGl0eURvYz4KCQkJPCEtLSBbMS4uMV0g0KHQstC10LTQtdC90LjRjyDQviDQv9C+0LvQuNGB0LUg0J7QnNChINC/0LDRhtC40LXQvdGC0LAgLS0+CgkJCTxpZGVudGl0eTpJbnN1cmFuY2VQb2xpY3k+CgkJCQk8IS0tIFIgWzEuLjFdINCS0LjQtCDQv9C+0LvQuNGB0LAg0J7QnNChIC0tPgoJCQkJPGlkZW50aXR5Okluc3VyYW5jZVBvbGljeVR5cGUgY29kZT0iMSIgY29kZVN5c3RlbT0iMS4yLjY0My41LjEuMTMuMTMuMTEuMTAzNSIgY29kZVN5c3RlbU5hbWU9ItCS0LjQtNGLINC/0L7Qu9C40YHQsCDQvtCx0Y/Qt9Cw0YLQtdC70YzQvdC+0LPQviDQvNC10LTQuNGG0LjQvdGB0LrQvtCz0L4g0YHRgtGA0LDRhdC+0LLQsNC90LjRjyIgZGlzcGxheU5hbWU9ItCf0L7Qu9C40YEg0J7QnNChINGB0YLQsNGA0L7Qs9C+INC+0LHRgNCw0LfRhtCwIiBjb2RlU3lzdGVtVmVyc2lvbj0iMS4zIiAvPgoJCQkJPCEtLSBbMC4uMV0g0KHQtdGA0LjRjyDQv9C+0LvQuNGB0LAg0J7QnNChIC0tPgoJCQkJPGlkZW50aXR5OlNlcmllcz50ZXN0c2VyaTwvaWRlbnRpdHk6U2VyaWVzPgoJCQkJPCEtLSBSIFsxLi4xXSDQndC+0LzQtdGAINC/0L7Qu9C40YHQsCDQntCc0KEgLS0+CgkJCQk8aWRlbnRpdHk6TnVtYmVyPjEzNDQ2MDA8L2lkZW50aXR5Ok51bWJlcj4KCQkJPC9pZGVudGl0eTpJbnN1cmFuY2VQb2xpY3k+CgkJCTwhLS0gWzEuLjJdINCQ0LTRgNC10YEg0L/QsNGG0LjQtdC90YLQsCAtLT4KCQkJPGFkZHI+CgkJCQk8IS0tIFIgWzEuLjFdINCi0LjQvyDQsNC00YDQtdGB0LAgLS0+CgkJCQk8YWRkcmVzczpUeXBlIGNvZGU9IjEiIGNvZGVTeXN0ZW09IjEuMi42NDMuNS4xLjEzLjEzLjExLjE1MDQiIGNvZGVTeXN0ZW1OYW1lPSLQotC40L8g0LDQtNGA0LXRgdCwINC/0LDRhtC40LXQvdGC0LAiIGNvZGVTeXN0ZW1WZXJzaW9uPSIxLjQiIGRpc3BsYXlOYW1lPSLQkNC00YDQtdGBINC/0L4g0LzQtdGB0YLRgyDQttC40YLQtdC70YzRgdGC0LLQsCAo0L/QvtGB0YLQvtGP0L3QvdC+0Lkg0YDQtdCz0LjRgdGC0YDQsNGG0LjQuCkiIC8+CgkJCQk8IS0tIFIgWzEuLjFdINCQ0LTRgNC10YEgKNGC0LXQutGB0YLQvtC8KSAtLT4KCQkJCTxzdHJlZXRBZGRyZXNzTGluZT50ZXN0IGFkcmVzczwvc3RyZWV0QWRkcmVzc0xpbmU+CgkJCQk8IS0tIFIgWzEuLjFdINCa0L7QtCDRgdGD0LHRitC10LrRgtCwINCg0KQgLS0+CgkJCQk8YWRkcmVzczpzdGF0ZUNvZGUgY29kZT0iMDEiIGNvZGVTeXN0ZW09IjEuMi42NDMuNS4xLjEzLjEzLjk5LjIuMjA2IiBjb2RlU3lzdGVtTmFtZT0i0KHRg9Cx0YrQtdC60YLRiyDQoNC+0YHRgdC40LnRgdC60L7QuSDQpNC10LTQtdGA0LDRhtC40LgiIGRpc3BsYXlOYW1lPSLQoNC10YHQv9GD0LHQu9C40LrQsCDQkNC00YvQs9C10Y8gKNCQ0LTRi9Cz0LXRjykiIGNvZGVTeXN0ZW1WZXJzaW9uPSI2LjUiIC8+CgkJCQk8IS0tIFsxLi4xXSDQn9C+0YfRgtC+0LLRi9C5INC40L3QtNC10LrRgSAtLT4KCQkJCTxwb3N0YWxDb2RlPnpTQVNgMTJgMTwvcG9zdGFsQ29kZT4KCQkJCTwhLS0gWzEuLjFdINCY0LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINCw0LTRgNC10YHQsCDQv9C+INCk0JjQkNChIC0tPgoJCQkJPGZpYXM6QWRkcmVzcz4KCQkJCQk8IS0tIFIgWzEuLjFdINCT0LvQvtCx0LDQu9GM0L3Ri9C5INGD0L3QuNC60LDQu9GM0L3Ri9C5INC40LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINCw0LTRgNC10YHQvdC+0LPQviDQvtCx0YrQtdC60YLQsCAtLT4KCQkJCQk8ZmlhczpBT0dVSUQ+NzgwNzk1MTItMDM0ZS00NjdmLWIwOGMtODY5YTkxNTcwZWNmPC9maWFzOkFPR1VJRD4KCQkJCQk8IS0tIFsxLi4xXSDQk9C70L7QsdCw0LvRjNC90YvQuSDRg9C90LjQutCw0LvRjNC90YvQuSDQuNC00LXQvdGC0LjRhNC40LrQsNGC0L7RgCDQtNC+0LzQsCAtLT4KCQkJCQk8ZmlhczpIT1VTRUdVSUQ+YzQzZjZmNDktM2QwZS00OTE1LWIxZTktY2JlNzgyODU0NGUyPC9maWFzOkhPVVNFR1VJRD4KCQkJCTwvZmlhczpBZGRyZXNzPgoJCQk8L2FkZHI+CgkJCTwhLS0gWzAuLipdINCa0L7QvdGC0LDQutGC0Ysg0L/QsNGG0LjQtdC90YLQsCAtLT4KCQkJPHRlbGVjb20gdXNlPSJXUCIgdmFsdWU9InRlbDo5OTQ3NzU2NDc0MzciIC8+CgkJCTwhLS0gUiBbMS4uMV0tLT4KCQkJPHBhdGllbnQ+CgkJCQk8IS0tIFIgWzEuLjFdINCk0JjQniDQv9Cw0YbQuNC10L3RgtCwIC0tPgoJCQkJPG5hbWU+CgkJCQkJPCEtLSBSIFsxLi4xXSDQpNCw0LzQuNC70LjRjyAtLT4KCQkJCQk8ZmFtaWx5PmtoYWxpZDwvZmFtaWx5PgoJCQkJCTwhLS0gUiBbMS4uMV0g0JjQvNGPIC0tPgoJCQkJCTxnaXZlbj5zYWhpbDwvZ2l2ZW4+CgkJCQkJPCEtLSBbMC4uMV0g0J7RgtGH0LXRgdGC0LLQviAtLT4KCQkJCQk8aWRlbnRpdHk6UGF0cm9ueW1pYz5hZG1pbjwvaWRlbnRpdHk6UGF0cm9ueW1pYz4KCQkJCTwvbmFtZT4KCQkJCTwhLS0gWzEuLjFdINCf0L7QuyDQv9Cw0YbQuNC10L3RgtCwIC0tPgoJCQkJPGFkbWluaXN0cmF0aXZlR2VuZGVyQ29kZSBjb2RlPSIyIiBjb2RlU3lzdGVtPSIxLjIuNjQzLjUuMS4xMy4xMy4xMS4xMDQwIiBjb2RlU3lzdGVtTmFtZT0i0J/QvtC7INC/0LDRhtC40LXQvdGC0LAiIGRpc3BsYXlOYW1lPSLQnNGD0LbRgdC60L7QuSIgY29kZVN5c3RlbVZlcnNpb249IjIuMSIgLz4KCQkJCTwhLS0gWzEuLjFdINCU0LDRgtCwINGA0L7QttC00LXQvdC40Y8g0L/QsNGG0LjQtdC90YLQsCAtLT4KCQkJCTxiaXJ0aFRpbWUgdmFsdWU9IjE5OTEwMTEyIiAvPgoJCQkJPCEtLSBbMC4uMV0g0KHQstC10LTQtdC90LjRjyDQviDQt9Cw0LrQvtC90L3QvtC8ICjRg9C/0L7Qu9C90L7QvNC+0YfQtdC90L3QvtC8KSDQv9GA0LXQtNGB0YLQsNCy0LjRgtC10LvQtSDQs9GA0LDQttC00LDQvdC40L3QsCAtLT4KCQkJPC9wYXRpZW50PgoJCQk8IS0tIFIgWzEuLjFdINCh0LLQtdC00LXQvdC40Y8g0L7QsSDQvtGA0LPQsNC90LjQt9Cw0YbQuNC4LCDQvtC60LDQt9GL0LLQsNGO0YnQtdC5INC80LXQtNC40YbQuNC90YHQutGD0Y4g0L/QvtC80L7RidGMIC0tPgoJCQk8cHJvdmlkZXJPcmdhbml6YXRpb24+CgkJCQk8IS0tIFIgWzEuLjFdINCj0L3QuNC60LDQu9GM0L3Ri9C5INC40LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINC80LXQtNC40YbQuNC90YHQutC+0Lkg0L7RgNCz0LDQvdC40LfQsNGG0LjQuCDQuCAo0L/RgNC4INC90LDQu9C40YfQuNC4KSDRg9C90LjQutCw0LvRjNC90YvQuSDQuNC00LXQvdGC0LjRhNC40LrQsNGC0L7RgCDRgdGC0YDRg9C60YLRg9GA0L3QvtCz0L4g0L/QvtC00YDQsNC30LTQtdC70LXQvdC40Y8gLS0+CgkJCQk8aWQgcm9vdD0iMS4yLjY0My41LjEuMTMuMTMuMTIuMi43Ny43ODMxIiBleHRlbnNpb249IjEuMi42NDMuNS4xLjEzLjEzLjEyLjIuNzcuNzgzMS4wLjEwNzUzMSIgLz4KCQkJCTwhLS0gWzAuLjFdINCh0LLQtdC00LXQvdC40Y8g0L4g0LvQuNGG0LXQvdC30LjQuCDQvdCwINC+0YHRg9GJ0LXRgdGC0LLQu9C10L3QuNC1INC80LXQtNC40YbQuNC90YHQutC+0Lkg0LTQtdGP0YLQtdC70YzQvdC+0YHRgtC4IC0tPgoJCQkJPGlkIHJvb3Q9IjEuMi42NDMuNS4xLjEzLjIuMS4xLjE1MDQuMTAxIiBleHRlbnNpb249ItCb0J4tNzctMDEtMDE5NzEwIiBhc3NpZ25pbmdBdXRob3JpdHlOYW1lPSLQlNC10L/QsNGA0YLQsNC80LXQvdGCINC30LTRgNCw0LLQvtC+0YXRgNCw0L3QtdC90LjRjyDQsy4g0JzQvtGB0LrQstGLLiDQlNCw0YLQsCDRgNC10LPQuNGB0YLRgNCw0YbQuNC4OiAyNi4wMS4yMDIz0LMuIiAvPgoJCQkJPCEtLSBbMS4uMV0g0KDQtdC60LLQuNC30LjRgtGLINC+0YDQs9Cw0L3QuNC30LDRhtC40LggLS0+CgkJCQk8aWRlbnRpdHk6UHJvcHM+CgkJCQkJPCEtLSBbMC4uMV0g0JrQvtC0INCe0JPQoNCdIC0tPgoJCQkJCTxpZGVudGl0eTpPZ3JuPjEwMjc3Mzk1Nzg0MDQ8L2lkZW50aXR5Ok9ncm4+CgkJCQkJPCEtLSBbMC4uMV0g0JrQvtC0INCe0JPQoNCd0JjQnyAtLT4KCQkJCQk8IS0tIFswLi4xXSDQmtC+0LQg0J7QmtCf0J4gLS0+CgkJCQkJPGlkZW50aXR5Ok9rcG8+NTAwOTI0NzwvaWRlbnRpdHk6T2twbz4KCQkJCQk8IS0tIFswLi4xXSDQmtC+0LQg0J7QmtCQ0KLQniAtLT4KCQkJCQk8aWRlbnRpdHk6T2thdG8+NDUyNjM1OTQwMDA8L2lkZW50aXR5Ok9rYXRvPgoJCQkJPC9pZGVudGl0eTpQcm9wcz4KCQkJCTwhLS0gUiBbMS4uMV0g0J3QsNC40LzQtdC90L7QstCw0L3QuNC1INC80LXQtNC40YbQuNC90YHQutC+0Lkg0L7RgNCz0LDQvdC40LfQsNGG0LjQuCDQuNC70Lgg0KTQmNCeINCY0J8gLS0+CgkJCQk8bmFtZT4zOHRlc3Q8L25hbWU+CgkJCQk8IS0tIFswLi4qXSDQmtC+0L3RgtCw0LrRgtGLINC80LXQtNC40YbQuNC90YHQutC+0Lkg0L7RgNCz0LDQvdC40LfQsNGG0LjQuCDQuNC70Lgg0JjQnyAtLT4KCQkJCTx0ZWxlY29tIHVzZT0iV1AiIHZhbHVlPSJ0ZWw6Kzc4MDA1NTAwODk2dGVzdCIgLz4KCQkJCTwhLS0gWzAuLipdINCa0L7QvdGC0LDQutGC0Ysg0LzQtdC00LjRhtC40L3RgdC60L7QuSDQvtGA0LPQsNC90LjQt9Cw0YbQuNC4INC40LvQuCDQmNCfIC0tPgoJCQkJPHRlbGVjb20gdmFsdWU9Im1haWx0bzppbmZvQG1hdHJpeGNybS5ydSIgLz4KCQkJCTwhLS0gWzAuLjFdINCQ0LTRgNC10YEg0LzQtdC00LjRhtC40L3RgdC60L7QuSDQvtGA0LPQsNC90LjQt9Cw0YbQuNC4INC40LvQuCDQmNCfIC0tPgoJCQkJPGFkZHI+CgkJCQkJPCEtLSBSIFsxLi4xXSDQkNC00YDQtdGBICjRgtC10LrRgdGC0L7QvCkgLS0+CgkJCQkJPHN0cmVldEFkZHJlc3NMaW5lPtCc0L7RgdC60LLQsCwgUnVzc2lhdGVzdDwvc3RyZWV0QWRkcmVzc0xpbmU+CgkJCQkJPCEtLSBSIFsxLi4xXSDQmtC+0LQg0YHRg9Cx0YrQtdC60YLQsCDQoNCkIC0tPgoJCQkJCTxhZGRyZXNzOnN0YXRlQ29kZSBjb2RlPSI2OCIgY29kZVN5c3RlbT0iMS4yLjY0My41LjEuMTMuMTMuOTkuMi4yMDYiIGNvZGVTeXN0ZW1OYW1lPSLQodGD0LHRitC10LrRgtGLINCg0L7RgdGB0LjQudGB0LrQvtC5INCk0LXQtNC10YDQsNGG0LjQuCIgZGlzcGxheU5hbWU9ItCi0LDQvNCx0L7QstGB0LrQsNGPINC+0LHQu9Cw0YHRgtGMIiBjb2RlU3lzdGVtVmVyc2lvbj0iNi41IiAvPgoJCQkJCTwhLS0gWzEuLjFdINCf0L7Rh9GC0L7QstGL0Lkg0LjQvdC00LXQutGBIC0tPgoJCQkJCTxwb3N0YWxDb2RlPnRlc3QgcG9zdGFsY29kZTM4dGVzdDwvcG9zdGFsQ29kZT4KCQkJCQk8IS0tIFsxLi4xXSDQmNC00LXQvdGC0LjRhNC40LrQsNGC0L7RgCDQsNC00YDQtdGB0LAg0L/QviDQpNCY0JDQoSAtLT4KCQkJCQk8ZmlhczpBZGRyZXNzPgoJCQkJCQk8IS0tIFIgWzEuLjFdINCT0LvQvtCx0LDQu9GM0L3Ri9C5INGD0L3QuNC60LDQu9GM0L3Ri9C5INC40LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINCw0LTRgNC10YHQvdC+0LPQviDQvtCx0YrQtdC60YLQsCAtLT4KCQkJCQkJPGZpYXM6QU9HVUlEPjdiZTMzNDJmLWRiZjEtNDg0OS1iNzM1LTI3MWNiNzEzNTU5ZDwvZmlhczpBT0dVSUQ+CgkJCQkJCTwhLS0gWzEuLjFdINCT0LvQvtCx0LDQu9GM0L3Ri9C5INGD0L3QuNC60LDQu9GM0L3Ri9C5INC40LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINC00L7QvNCwIC0tPgoJCQkJCQk8ZmlhczpIT1VTRUdVSUQ+MTgyYmU2YjUtMGIxOC00MGJjLWI2ZjAtNTM3NmIyYWZjNzNjPC9maWFzOkhPVVNFR1VJRD4KCQkJCQk8L2ZpYXM6QWRkcmVzcz4KCQkJCTwvYWRkcj4KCQkJPC9wcm92aWRlck9yZ2FuaXphdGlvbj4KCQk8L3BhdGllbnRSb2xlPgoJPC9yZWNvcmRUYXJnZXQ+Cgk8IS0tIFIgWzEuLjFdINCh0LLQtdC00LXQvdC40Y8g0L7QsSDQsNCy0YLQvtGA0LUg0LTQvtC60YPQvNC10L3RgtCwIC0tPgoJPGF1dGhvcj4KCQk8IS0tIFsxLi4xXS0tPgoJCTx0aW1lIG51bGxGbGF2b3I9Ik5JIiAvPgoJCTwhLS0gUiBbMS4uMV0tLT4KCQk8YXNzaWduZWRBdXRob3I+CgkJCTwhLS0gUiBbMS4uMV0g0KPQvdC40LrQsNC70YzQvdGL0Lkg0LjQtNC10L3RgtC40YTQuNC60LDRgtC+0YAg0LDQstGC0L7RgNCwINCyINCc0JjQoSAtLT4KCQkJPGlkIHJvb3Q9IjEuMi42NDMuNS4xLjEzLjEzLjEyLjIuNzcuNzgzMS4xMDAuMS4xLjcwIiBleHRlbnNpb249IjU0MjE3NCIgLz4KCQkJPCEtLSBSIFsxLi4xXSDQodCd0JjQm9ChINCw0LLRgtC+0YDQsCAtLT4KCQkJPGlkIHJvb3Q9IjEuMi42NDMuMTAwLjMiIGV4dGVuc2lvbj0iNTI0MTUzNzIzMTIiIC8+CgkJCTwhLS0gUiBbMS4uMV0g0JrQvtC0INC00L7Qu9C20L3QvtGB0YLQuCDQsNCy0YLQvtGA0LAgLS0+CgkJCTxjb2RlIGNvZGU9IjIwMDAwMDAwMDAiIGNvZGVTeXN0ZW09IjEuMi42NDMuNS4xLjEzLjEzLjExLjEwMDIiIGNvZGVTeXN0ZW1OYW1lPSLQlNC+0LvQttC90L7RgdGC0Lgg0LzQtdC00LjRhtC40L3RgdC60LjRhSDQuCDRhNCw0YDQvNCw0YbQtdCy0YLQuNGH0LXRgdC60LjRhSDRgNCw0LHQvtGC0L3QuNC60L7QsiIgZGlzcGxheU5hbWU9ItCS0YDQsNGHLdGC0LXRgNCw0L/QtdCy0YJ0ZXN0IiBjb2RlU3lzdGVtVmVyc2lvbj0iOS4zIiAvPgoJCQk8IS0tIFswLi4xXSDQkNC00YDQtdGBINC80LXRgdGC0LAg0YDQsNCx0L7RgtGLINCw0LLRgtC+0YDQsCDQtNC+0LrRg9C80LXQvdGC0LAgLS0+CgkJCTxhZGRyPgoJCQkJPCEtLSBSIFsxLi4xXSDQkNC00YDQtdGBICjRgtC10LrRgdGC0L7QvCkgLS0+CgkJCQk8c3RyZWV0QWRkcmVzc0xpbmU+dGVzdDwvc3RyZWV0QWRkcmVzc0xpbmU+CgkJCQk8IS0tIFIgWzEuLjFdINCa0L7QtCDRgdGD0LHRitC10LrRgtCwINCg0KQgLS0+CgkJCQk8YWRkcmVzczpzdGF0ZUNvZGUgY29kZT0iNzciIGNvZGVTeXN0ZW09IjEuMi42NDMuNS4xLjEzLjEzLjk5LjIuMjA2IiBjb2RlU3lzdGVtTmFtZT0i0KHRg9Cx0YrQtdC60YLRiyDQoNC+0YHRgdC40LnRgdC60L7QuSDQpNC10LTQtdGA0LDRhtC40LgiIGRpc3BsYXlOYW1lPSLQsy4g0JzQvtGB0LrQstCwIiBjb2RlU3lzdGVtVmVyc2lvbj0iNi41IiAvPgoJCQkJPCEtLSBbMS4uMV0g0J/QvtGH0YLQvtCy0YvQuSDQuNC90LTQtdC60YEgLS0+CgkJCQk8cG9zdGFsQ29kZT4xMDUwMDU8L3Bvc3RhbENvZGU+CgkJCQk8IS0tIFsxLi4xXSDQmNC00LXQvdGC0LjRhNC40LrQsNGC0L7RgCDQsNC00YDQtdGB0LAg0L/QviDQpNCY0JDQoSAtLT4KCQkJCTxmaWFzOkFkZHJlc3M+CgkJCQkJPCEtLSBSIFsxLi4xXSDQk9C70L7QsdCw0LvRjNC90YvQuSDRg9C90LjQutCw0LvRjNC90YvQuSDQuNC00LXQvdGC0LjRhNC40LrQsNGC0L7RgCDQsNC00YDQtdGB0L3QvtCz0L4g0L7QsdGK0LXQutGC0LAgLS0+CgkJCQkJPGZpYXM6QU9HVUlEPjQ2NjhmNWMwLWYzNTctNDE4Mi05ZmQyLWZlMWY3YTk1MGFjNzwvZmlhczpBT0dVSUQ+CgkJCQkJPCEtLSBbMS4uMV0g0JPQu9C+0LHQsNC70YzQvdGL0Lkg0YPQvdC40LrQsNC70YzQvdGL0Lkg0LjQtNC10L3RgtC40YTQuNC60LDRgtC+0YAg0LTQvtC80LAgLS0+CgkJCQkJPGZpYXM6SE9VU0VHVUlEPjNkNzFjNjE4LThjZTQtNGE2NC1iOTNmLTgxNzkzNTg4MDZhZjwvZmlhczpIT1VTRUdVSUQ+CgkJCQk8L2ZpYXM6QWRkcmVzcz4KCQkJPC9hZGRyPgoJCQk8IS0tIFswLi4qXSDQmtC+0L3RgtCw0LrRgtGLINCw0LLRgtC+0YDQsCAtLT4KCQkJPHRlbGVjb20gdXNlPSJXUCIgdmFsdWU9InRlbDp0ZXN0IiAvPgoJCQk8IS0tIFIgWzEuLjFdLS0+CgkJCTxhc3NpZ25lZFBlcnNvbj4KCQkJCTwhLS0gUiBbMS4uMV0g0KTQmNCeINCw0LLRgtC+0YDQsCAtLT4KCQkJCTxuYW1lPgoJCQkJCTwhLS0gUiBbMS4uMV0g0KTQsNC80LjQu9C40Y8gLS0+CgkJCQkJPGZhbWlseT5kb2N0b3J0ZXN0PC9mYW1pbHk+CgkJCQkJPCEtLSBSIFsxLi4xXSDQmNC80Y8gLS0+CgkJCQkJPGdpdmVuPnNhaGlsdGVzdDwvZ2l2ZW4+CgkJCQkJPCEtLSBbMC4uMV0g0J7RgtGH0LXRgdGC0LLQviAtLT4KCQkJCQk8aWRlbnRpdHk6UGF0cm9ueW1pYyB4c2k6dHlwZT0iU1QiPmFkbWludGVzdDwvaWRlbnRpdHk6UGF0cm9ueW1pYz4KCQkJCTwvbmFtZT4KCQkJPC9hc3NpZ25lZFBlcnNvbj4KCQkJPCEtLSBbMC4uMV0g0KHQstC10LTQtdC90LjRjyDQviDQvNC10LTQuNGG0LjQvdGB0LrQvtC5INC+0YDQs9Cw0L3QuNC30LDRhtC40LgsINCz0LTQtSDRgNCw0LHQvtGC0LDQtdGCINCw0LLRgtC+0YAgLS0+CgkJCTxyZXByZXNlbnRlZE9yZ2FuaXphdGlvbiBjbGFzc0NvZGU9Ik9SRyI+CgkJCQk8IS0tIFIgWzEuLjFdINCj0L3QuNC60LDQu9GM0L3Ri9C5INC40LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINC80LXQtNC40YbQuNC90YHQutC+0Lkg0L7RgNCz0LDQvdC40LfQsNGG0LjQuCDQuCAo0L/RgNC4INC90LDQu9C40YfQuNC4KSDRg9C90LjQutCw0LvRjNC90YvQuSDQuNC00LXQvdGC0LjRhNC40LrQsNGC0L7RgCDRgdGC0YDRg9C60YLRg9GA0L3QvtCz0L4g0L/QvtC00YDQsNC30LTQtdC70LXQvdC40Y8gLS0+CgkJCQk8aWQgcm9vdD0iMS4yLjY0My41LjEuMTMuMTMuMTIuMi43Ny43ODMxIiBleHRlbnNpb249IjEuMi42NDMuNS4xLjEzLjEzLjEyLjIuNzcuNzgzMS4wLjEwNzUzMSIgLz4KCQkJCTwhLS0gUiBbMS4uMV0g0J3QsNC40LzQtdC90L7QstCw0L3QuNC1INC80LXQtNC40YbQuNC90YHQutC+0Lkg0L7RgNCz0LDQvdC40LfQsNGG0LjQuCDQuNC70Lgg0KTQmNCeINCY0J8gLS0+CgkJCQk8bmFtZT4zOHRlc3Q8L25hbWU+CgkJCQk8IS0tIFswLi4qXSDQmtC+0L3RgtCw0LrRgtGLINC80LXQtNC40YbQuNC90YHQutC+0Lkg0L7RgNCz0LDQvdC40LfQsNGG0LjQuCDQuNC70Lgg0JjQnyAtLT4KCQkJCTx0ZWxlY29tIHVzZT0iV1AiIHZhbHVlPSJ0ZWw6Kzc4MDA1NTAwODk2dGVzdCIgLz4KCQkJCTwhLS0gWzAuLjFdINCQ0LTRgNC10YEg0LzQtdC00LjRhtC40L3RgdC60L7QuSDQvtGA0LPQsNC90LjQt9Cw0YbQuNC4INC40LvQuCDQmNCfIC0tPgoJCQkJPGFkZHI+CgkJCQkJPCEtLSBSIFsxLi4xXSDQkNC00YDQtdGBICjRgtC10LrRgdGC0L7QvCkgLS0+CgkJCQkJPHN0cmVldEFkZHJlc3NMaW5lPtCc0L7RgdC60LLQsCwgUnVzc2lhdGVzdDwvc3RyZWV0QWRkcmVzc0xpbmU+CgkJCQkJPCEtLSBSIFsxLi4xXSDQmtC+0LQg0YHRg9Cx0YrQtdC60YLQsCDQoNCkIC0tPgoJCQkJCTxhZGRyZXNzOnN0YXRlQ29kZSBjb2RlPSI2OCIgY29kZVN5c3RlbT0iMS4yLjY0My41LjEuMTMuMTMuOTkuMi4yMDYiIGNvZGVTeXN0ZW1OYW1lPSLQodGD0LHRitC10LrRgtGLINCg0L7RgdGB0LjQudGB0LrQvtC5INCk0LXQtNC10YDQsNGG0LjQuCIgZGlzcGxheU5hbWU9ItCzLiDQnNC+0YHQutCy0LAiIGNvZGVTeXN0ZW1WZXJzaW9uPSI2LjUiIC8+CgkJCQkJPCEtLSBbMS4uMV0g0J/QvtGH0YLQvtCy0YvQuSDQuNC90LTQtdC60YEgLS0+CgkJCQkJPHBvc3RhbENvZGU+dGVzdCBwb3N0YWxjb2RlMzh0ZXN0PC9wb3N0YWxDb2RlPgoJCQkJCTwhLS0gWzEuLjFdINCY0LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINCw0LTRgNC10YHQsCDQv9C+INCk0JjQkNChIC0tPgoJCQkJCTxmaWFzOkFkZHJlc3M+CgkJCQkJCTwhLS0gUiBbMS4uMV0g0JPQu9C+0LHQsNC70YzQvdGL0Lkg0YPQvdC40LrQsNC70YzQvdGL0Lkg0LjQtNC10L3RgtC40YTQuNC60LDRgtC+0YAg0LDQtNGA0LXRgdC90L7Qs9C+INC+0LHRitC10LrRgtCwIC0tPgoJCQkJCQk8ZmlhczpBT0dVSUQ+YjU5YmM3N2EtNTQwYy00NTcwLWIwNDctNGUwNzQ5ZDc3NmVmPC9maWFzOkFPR1VJRD4KCQkJCQkJPCEtLSBbMS4uMV0g0JPQu9C+0LHQsNC70YzQvdGL0Lkg0YPQvdC40LrQsNC70YzQvdGL0Lkg0LjQtNC10L3RgtC40YTQuNC60LDRgtC+0YAg0LTQvtC80LAgLS0+CgkJCQkJCTxmaWFzOkhPVVNFR1VJRD40OGYzMGI2My03ZGM0LTRmOWMtYjJiMy1jNjc5Y2M1NGIyYTA8L2ZpYXM6SE9VU0VHVUlEPgoJCQkJCTwvZmlhczpBZGRyZXNzPgoJCQkJPC9hZGRyPgoJCQk8L3JlcHJlc2VudGVkT3JnYW5pemF0aW9uPgoJCTwvYXNzaWduZWRBdXRob3I+Cgk8L2F1dGhvcj4KCTwhLS0gUiBbMS4uMV0g0KHQstC10LTQtdC90LjRjyDQviDQstC70LDQtNC10LvRjNGG0LUg0LTQvtC60YPQvNC10L3RgtCwIC0tPgoJPGN1c3RvZGlhbj4KCQk8IS0tIFIgWzEuLjFdLS0+CgkJPGFzc2lnbmVkQ3VzdG9kaWFuPgoJCQk8IS0tIFIgWzEuLjFdINCh0LLQtdC00LXQvdC40Y8g0L7QsSDQvtGA0LPQsNC90LjQt9Cw0YbQuNC4LdCy0LvQsNC00LXQu9GM0YbQtSDQtNC+0LrRg9C80LXQvdGC0LAgLS0+CgkJCTxyZXByZXNlbnRlZEN1c3RvZGlhbk9yZ2FuaXphdGlvbiBjbGFzc0NvZGU9Ik9SRyI+CgkJCQk8IS0tIFIgWzEuLjFdINCj0L3QuNC60LDQu9GM0L3Ri9C5INC40LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINC80LXQtNC40YbQuNC90YHQutC+0Lkg0L7RgNCz0LDQvdC40LfQsNGG0LjQuCDQuCAo0L/RgNC4INC90LDQu9C40YfQuNC4KSDRg9C90LjQutCw0LvRjNC90YvQuSDQuNC00LXQvdGC0LjRhNC40LrQsNGC0L7RgCDRgdGC0YDRg9C60YLRg9GA0L3QvtCz0L4g0L/QvtC00YDQsNC30LTQtdC70LXQvdC40Y8gLS0+CgkJCQk8aWQgcm9vdD0iN2EwYzVlMjQtMzA5ZC0xMWViLWJiZTAtMDA1MDU2ODMwM2JldGVzdCIgLz4KCQkJCTwhLS0gUiBbMS4uMV0g0J3QsNC40LzQtdC90L7QstCw0L3QuNC1INC+0YDQs9Cw0L3QuNC30LDRhtC40Lgg0LjQu9C4INCk0JjQniDQmNCfIC0tPgoJCQkJPG5hbWU+Mzh0ZXN0PC9uYW1lPgoJCQkJPCEtLSBbMC4uMV0g0KLQtdC70LXRhNC+0L0g0LzQtdC00LjRhtC40L3RgdC60L7QuSDQvtGA0LPQsNC90LjQt9Cw0YbQuNC4INC40LvQuCDQmNCfIC0tPgoJCQkJPHRlbGVjb20gdXNlPSJXUCIgdmFsdWU9InRlbDorNzgwMDU1MDA4OTZ0ZXN0IiAvPgoJCQkJPCEtLSBSIFsxLi4xXSDQkNC00YDQtdGBINC80LXQtNC40YbQuNC90YHQutC+0Lkg0L7RgNCz0LDQvdC40LfQsNGG0LjQuCDQuNC70Lgg0JjQnyAtLT4KCQkJCTxhZGRyPgoJCQkJCTwhLS0gUiBbMS4uMV0g0JDQtNGA0LXRgSAo0YLQtdC60YHRgtC+0LwpIC0tPgoJCQkJCTxzdHJlZXRBZGRyZXNzTGluZT7QnNC+0YHQutCy0LAsIFJ1c3NpYXRlc3Q8L3N0cmVldEFkZHJlc3NMaW5lPgoJCQkJCTwhLS0gUiBbMS4uMV0g0JrQvtC0INGB0YPQsdGK0LXQutGC0LAg0KDQpCAtLT4KCQkJCQk8YWRkcmVzczpzdGF0ZUNvZGUgY29kZT0iNjgiIGNvZGVTeXN0ZW09IjEuMi42NDMuNS4xLjEzLjEzLjk5LjIuMjA2IiBjb2RlU3lzdGVtTmFtZT0i0KHRg9Cx0YrQtdC60YLRiyDQoNC+0YHRgdC40LnRgdC60L7QuSDQpNC10LTQtdGA0LDRhtC40LgiIGRpc3BsYXlOYW1lPSLQotCw0LzQsdC+0LLRgdC60LDRjyDQvtCx0LvQsNGB0YLRjCIgY29kZVN5c3RlbVZlcnNpb249IjYuNSIgLz4KCQkJCQk8IS0tIFsxLi4xXSDQn9C+0YfRgtC+0LLRi9C5INC40L3QtNC10LrRgSAtLT4KCQkJCQk8cG9zdGFsQ29kZT50ZXN0IHBvc3RhbGNvZGUzOHRlc3Q8L3Bvc3RhbENvZGU+CgkJCQkJPCEtLSBbMS4uMV0g0JjQtNC10L3RgtC40YTQuNC60LDRgtC+0YAg0LDQtNGA0LXRgdCwINC/0L4g0KTQmNCQ0KEgLS0+CgkJCQkJPGZpYXM6QWRkcmVzcz4KCQkJCQkJPCEtLSBSIFsxLi4xXSDQk9C70L7QsdCw0LvRjNC90YvQuSDRg9C90LjQutCw0LvRjNC90YvQuSDQuNC00LXQvdGC0LjRhNC40LrQsNGC0L7RgCDQsNC00YDQtdGB0L3QvtCz0L4g0L7QsdGK0LXQutGC0LAgLS0+CgkJCQkJCTxmaWFzOkFPR1VJRD45OGZhZWRjMy0wNDVhLTQ0ZmYtOGU3Yi02ODgxZmI1ODU1ZmQ8L2ZpYXM6QU9HVUlEPgoJCQkJCQk8IS0tIFsxLi4xXSDQk9C70L7QsdCw0LvRjNC90YvQuSDRg9C90LjQutCw0LvRjNC90YvQuSDQuNC00LXQvdGC0LjRhNC40LrQsNGC0L7RgCDQtNC+0LzQsCAtLT4KCQkJCQkJPGZpYXM6SE9VU0VHVUlEPmU4Mzk4Y2U1LTI0NjAtNDAwZi04NTcwLTI1ODc4MjJlN2ZhOTwvZmlhczpIT1VTRUdVSUQ+CgkJCQkJPC9maWFzOkFkZHJlc3M+CgkJCQk8L2FkZHI+CgkJCTwvcmVwcmVzZW50ZWRDdXN0b2RpYW5Pcmdhbml6YXRpb24+CgkJPC9hc3NpZ25lZEN1c3RvZGlhbj4KCTwvY3VzdG9kaWFuPgoJPCEtLSBSIFsxLi4xXSDQodCy0LXQtNC10L3QuNGPINC+INC/0L7Qu9GD0YfQsNGC0LXQu9C1INC00L7QutGD0LzQtdC90YLQsCBbMV0gLS0+Cgk8aW5mb3JtYXRpb25SZWNpcGllbnQ+CgkJPCEtLSBSIFsxLi4xXS0tPgoJCTxpbnRlbmRlZFJlY2lwaWVudD4KCQkJPCEtLSBSIFsxLi4xXSDQodCy0LXQtNC10L3QuNGPINC+0LEg0L7RgNCz0LDQvdC40LfQsNGG0LjQuC3Qv9C+0LvRg9GH0LDRgtC10LvQtSDQtNC+0LrRg9C80LXQvdGC0LAgKNCg0K3QnNCUKSAtLT4KCQkJPHJlY2VpdmVkT3JnYW5pemF0aW9uPgoJCQkJPCEtLSBSIFsxLi4xXSDQo9C90LjQutCw0LvRjNC90YvQuSDQuNC00LXQvdGC0LjRhNC40LrQsNGC0L7RgCDQv9C+0LvRg9GH0LDRjtGJ0LXQuSDQvtGA0LPQsNC90LjQt9Cw0YbQuNC4IC0tPgoJCQkJPGlkIHJvb3Q9IjEuMi42NDMuNS4xLjEzIiAvPgoJCQkJPCEtLSBSIFsxLi4xXSDQndCw0LjQvNC10L3QvtCy0LDQvdC40LUg0L/QvtC70YPRh9Cw0Y7RidC10Lkg0L7RgNCz0LDQvdC40LfQsNGG0LjQuCAtLT4KCQkJCTxuYW1lPtCc0LjQvdC40YHRgtC10YDRgdGC0LLQviDQt9C00YDQsNCy0L7QvtGF0YDQsNC90LXQvdC40Y8g0KDQvtGB0YHQuNC50YHQutC+0Lkg0KTQtdC00LXRgNCw0YbQuNC4PC9uYW1lPgoJCQk8L3JlY2VpdmVkT3JnYW5pemF0aW9uPgoJCTwvaW50ZW5kZWRSZWNpcGllbnQ+Cgk8L2luZm9ybWF0aW9uUmVjaXBpZW50PgoJPCEtLSBbMC4uKl0g0KHQstC10LTQtdC90LjRjyDQviDQv9C+0LvRg9GH0LDRgtC10LvQtSDQtNC+0LrRg9C80LXQvdGC0LAgWzJdIC0tPgoJPCEtLSBSIFsxLi4xXSDQodCy0LXQtNC10L3QuNGPINC+INC70LjRhtC1LCDQv9GA0LjQtNCw0LLRiNC10Lwg0Y7RgNC40LTQuNGH0LXRgdC60YPRjiDRgdC40LvRgyDQtNC+0LrRg9C80LXQvdGC0YMgLS0+Cgk8bGVnYWxBdXRoZW50aWNhdG9yPgoJCTwhLS0gWzEuLjFdLS0+CgkJPHRpbWUgbnVsbEZsYXZvcj0iTkkiIC8+CgkJPCEtLSBbMS4uMV0tLT4KCQk8c2lnbmF0dXJlQ29kZSBudWxsRmxhdm9yPSJOSSIgLz4KCQk8IS0tIFIgWzEuLjFdLS0+CgkJPGFzc2lnbmVkRW50aXR5PgoJCQk8IS0tIFIgWzEuLjFdINCj0L3QuNC60LDQu9GM0L3Ri9C5INC40LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINC70LjRhtCwLCDQv9GA0LjQtNCw0LLRiNC10LPQviDRjtGA0LjQtNC40YfQtdGB0LrRg9GOINGB0LjQu9GDINC00L7QutGD0LzQtdC90YLRgywg0LIg0JzQmNChIC0tPgoJCQk8aWQgcm9vdD0iZThjZDI3ZjYtODZhMS00NzMxLWFhZTctMzkzOTFkZTE3Yjc1dGVzdCIgZXh0ZW5zaW9uPSJlOGNkMjdmNi04NmExLTQ3MzEtYWFlNy0zOTM5MWRlMTdiNzV0ZXN0IiAvPgoJCQk8IS0tIFIgWzEuLjFdINCh0J3QmNCb0KEg0LvQuNGG0LAsINC/0YDQuNC00LDQstGI0LXQs9C+INGO0YDQuNC00LjRh9C10YHQutGD0Y4g0YHQuNC70YMg0LTQvtC60YPQvNC10L3RgtGDIC0tPgoJCQk8aWQgcm9vdD0iMS4yLjY0My4xMDAuMyIgZXh0ZW5zaW9uPSJnYnZzeXYyMXRlc3QiIC8+CgkJCTwhLS0gUiBbMS4uMV0g0JrQvtC0INC00L7Qu9C20L3QvtGB0YLQuCDQu9C40YbQsCwg0L/RgNC40LTQsNCy0YjQtdCz0L4g0Y7RgNC40LTQuNGH0LXRgdC60YPRjiDRgdC40LvRgyDQtNC+0LrRg9C80LXQvdGC0YMgLS0+CgkJCTxjb2RlIGNvZGVTeXN0ZW09IjEuMi42NDMuNS4xLjEzLjEzLjExLjEwMDIiIGNvZGVTeXN0ZW1OYW1lPSLQlNC+0LvQttC90L7RgdGC0Lgg0LzQtdC00LjRhtC40L3RgdC60LjRhSDQuCDRhNCw0YDQvNCw0YbQtdCy0YLQuNGH0LXRgdC60LjRhSDRgNCw0LHQvtGC0L3QuNC60L7QsiIgY29kZT0iMzM0IiBkaXNwbGF5TmFtZT0i0JPQu9Cw0LLQvdGL0Lkg0LLRgNCw0Ycg0LzQtdC00LjRhtC40L3RgdC60L7QuSDQvtGA0LPQsNC90LjQt9Cw0YbQuNC4IiBjb2RlU3lzdGVtVmVyc2lvbj0iOS4zIiAvPgoJCQk8IS0tIFswLi4xXSDQkNC00YDQtdGBINC80LXRgdGC0LAg0YDQsNCx0L7RgtGLINC70LjRhtCwLCDQv9GA0LjQtNCw0LLRiNC10LPQviDRjtGA0LjQtNC40YfQtdGB0LrRg9GOINGB0LjQu9GDINC00L7QutGD0LzQtdC90YLRgyAtLT4KCQkJPGFkZHI+CgkJCQk8IS0tIFIgWzEuLjFdINCQ0LTRgNC10YEgKNGC0LXQutGB0YLQvtC8KSAtLT4KCQkJCTxzdHJlZXRBZGRyZXNzTGluZT5CYWt1LCBHLkFsaXlldiA1NER0ZXN0PC9zdHJlZXRBZGRyZXNzTGluZT4KCQkJCTwhLS0gUiBbMS4uMV0g0JrQvtC0INGB0YPQsdGK0LXQutGC0LAg0KDQpCAtLT4KCQkJCTxhZGRyZXNzOnN0YXRlQ29kZSBjb2RlPSIwMSIgY29kZVN5c3RlbT0iMS4yLjY0My41LjEuMTMuMTMuOTkuMi4yMDYiIGNvZGVTeXN0ZW1OYW1lPSLQodGD0LHRitC10LrRgtGLINCg0L7RgdGB0LjQudGB0LrQvtC5INCk0LXQtNC10YDQsNGG0LjQuCIgZGlzcGxheU5hbWU9ItCg0LXRgdC/0YPQsdC70LjQutCwINCQ0LTRi9Cz0LXRjyAo0JDQtNGL0LPQtdGPKSIgY29kZVN5c3RlbVZlcnNpb249IjYuNSIgLz4KCQkJCTwhLS0gWzEuLjFdINCf0L7Rh9GC0L7QstGL0Lkg0LjQvdC00LXQutGBIC0tPgoJCQkJPHBvc3RhbENvZGU+dGVzdDwvcG9zdGFsQ29kZT4KCQkJCTwhLS0gWzEuLjFdINCY0LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINCw0LTRgNC10YHQsCDQv9C+INCk0JjQkNChIC0tPgoJCQkJPGZpYXM6QWRkcmVzcz4KCQkJCQk8IS0tIFIgWzEuLjFdINCT0LvQvtCx0LDQu9GM0L3Ri9C5INGD0L3QuNC60LDQu9GM0L3Ri9C5INC40LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINCw0LTRgNC10YHQvdC+0LPQviDQvtCx0YrQtdC60YLQsCAtLT4KCQkJCQk8ZmlhczpBT0dVSUQ+ZGUyYTJmMWQtMjcxMC00MjM0LTk1ZGItODA0ZjQzZDI2ZjU3PC9maWFzOkFPR1VJRD4KCQkJCQk8IS0tIFsxLi4xXSDQk9C70L7QsdCw0LvRjNC90YvQuSDRg9C90LjQutCw0LvRjNC90YvQuSDQuNC00LXQvdGC0LjRhNC40LrQsNGC0L7RgCDQtNC+0LzQsCAtLT4KCQkJCQk8ZmlhczpIT1VTRUdVSUQ+NDBjY2VmM2QtZjdmMC00MDdiLWJkYzctNTMwYmU0NmY2NDlkPC9maWFzOkhPVVNFR1VJRD4KCQkJCTwvZmlhczpBZGRyZXNzPgoJCQk8L2FkZHI+CgkJCTwhLS0gWzAuLipdINCa0L7QvdGC0LDQutGC0Ysg0LvQuNGG0LAsINC/0YDQuNC00LDQstGI0LXQs9C+INGO0YDQuNC00LjRh9C10YHQutGD0Y4g0YHQuNC70YMg0LTQvtC60YPQvNC10L3RgtGDIC0tPgoJCQk8dGVsZWNvbSB1c2U9IldQIiB2YWx1ZT0idGVsOnRlc3QiIC8+CgkJCTwhLS0gUiBbMS4uMV0tLT4KCQkJPGFzc2lnbmVkUGVyc29uPgoJCQkJPCEtLSBSIFsxLi4xXSDQpNCY0J4g0LvQuNGG0LAsINC/0YDQuNC00LDQstGI0LXQs9C+INGO0YDQuNC00LjRh9C10YHQutGD0Y4g0YHQuNC70YMg0LTQvtC60YPQvNC10L3RgtGDIC0tPgoJCQkJPG5hbWU+CgkJCQkJPCEtLSBSIFsxLi4xXSDQpNCw0LzQuNC70LjRjyAtLT4KCQkJCQk8ZmFtaWx5PlJhamFib3Z0ZXN0PC9mYW1pbHk+CgkJCQkJPCEtLSBSIFsxLi4xXSDQmNC80Y8gLS0+CgkJCQkJPGdpdmVuPktoYWxpZHRlc3Q8L2dpdmVuPgoJCQkJCTwhLS0gWzAuLjFdINCe0YLRh9C10YHRgtCy0L4gLS0+CgkJCQkJPGlkZW50aXR5OlBhdHJvbnltaWM+ZHNkdGVzdDwvaWRlbnRpdHk6UGF0cm9ueW1pYz4KCQkJCTwvbmFtZT4KCQkJPC9hc3NpZ25lZFBlcnNvbj4KCQkJPCEtLSBbMC4uMV0g0KHQstC10LTQtdC90LjRjyDQviDQvNC10LTQuNGG0LjQvdGB0LrQvtC5INC+0YDQs9Cw0L3QuNC30LDRhtC40LgsINCz0LTQtSDRgNCw0LHQvtGC0LDQtdGCINC70LjRhtC+LCDQv9GA0LjQtNCw0LLRiNC10LUg0Y7RgNC40LTQuNGH0LXRgdC60YPRjiDRgdC40LvRgyDQtNC+0LrRg9C80LXQvdGC0YMgLS0+CgkJCTxyZXByZXNlbnRlZE9yZ2FuaXphdGlvbiBjbGFzc0NvZGU9Ik9SRyI+CgkJCQk8IS0tIFIgWzEuLjFdINCj0L3QuNC60LDQu9GM0L3Ri9C5INC40LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINC80LXQtNC40YbQuNC90YHQutC+0Lkg0L7RgNCz0LDQvdC40LfQsNGG0LjQuCDQuCAo0L/RgNC4INC90LDQu9C40YfQuNC4KSDRg9C90LjQutCw0LvRjNC90YvQuSDQuNC00LXQvdGC0LjRhNC40LrQsNGC0L7RgCDRgdGC0YDRg9C60YLRg9GA0L3QvtCz0L4g0L/QvtC00YDQsNC30LTQtdC70LXQvdC40Y8gLS0+CgkJCQk8aWQgcm9vdD0iMS4yLjY0My41LjEuMTMuMTMuMTIuMi43Ny43ODMxIiAvPgoJCQkJPCEtLSBSIFsxLi4xXSDQndCw0LjQvNC10L3QvtCy0LDQvdC40LUg0LzQtdC00LjRhtC40L3RgdC60L7QuSDQvtGA0LPQsNC90LjQt9Cw0YbQuNC4INC40LvQuCDQpNCY0J4g0JjQnyAtLT4KCQkJCTxuYW1lPjM4dGVzdDwvbmFtZT4KCQkJCTwhLS0gWzAuLipdINCa0L7QvdGC0LDQutGC0Ysg0LzQtdC00LjRhtC40L3RgdC60L7QuSDQvtGA0LPQsNC90LjQt9Cw0YbQuNC4INC40LvQuCDQmNCfIC0tPgoJCQkJPHRlbGVjb20gdXNlPSJXUCIgdmFsdWU9InRlbDorNzgwMDU1MDA4OTZ0ZXN0IiAvPgoJCQkJPCEtLSBbMC4uMV0g0JDQtNGA0LXRgSDQvNC10LTQuNGG0LjQvdGB0LrQvtC5INC+0YDQs9Cw0L3QuNC30LDRhtC40Lgg0LjQu9C4INCY0J8gLS0+CgkJCQk8YWRkcj4KCQkJCQk8IS0tIFIgWzEuLjFdINCQ0LTRgNC10YEgKNGC0LXQutGB0YLQvtC8KSAtLT4KCQkJCQk8c3RyZWV0QWRkcmVzc0xpbmU+0JzQvtGB0LrQstCwLCBSdXNzaWF0ZXN0PC9zdHJlZXRBZGRyZXNzTGluZT4KCQkJCQk8IS0tIFIgWzEuLjFdINCa0L7QtCDRgdGD0LHRitC10LrRgtCwINCg0KQgLS0+CgkJCQkJPGFkZHJlc3M6c3RhdGVDb2RlIGNvZGU9IjY4IiBjb2RlU3lzdGVtPSIxLjIuNjQzLjUuMS4xMy4xMy45OS4yLjIwNiIgY29kZVN5c3RlbU5hbWU9ItCh0YPQsdGK0LXQutGC0Ysg0KDQvtGB0YHQuNC50YHQutC+0Lkg0KTQtdC00LXRgNCw0YbQuNC4IiBkaXNwbGF5TmFtZT0i0KLQsNC80LHQvtCy0YHQutCw0Y8g0L7QsdC70LDRgdGC0YwiIGNvZGVTeXN0ZW1WZXJzaW9uPSI2LjUiIC8+CgkJCQkJPCEtLSBbMS4uMV0g0J/QvtGH0YLQvtCy0YvQuSDQuNC90LTQtdC60YEgLS0+CgkJCQkJPHBvc3RhbENvZGU+dGVzdCBwb3N0YWxjb2RlMzh0ZXN0PC9wb3N0YWxDb2RlPgoJCQkJCTwhLS0gWzEuLjFdINCY0LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINCw0LTRgNC10YHQsCDQv9C+INCk0JjQkNChIC0tPgoJCQkJCTxmaWFzOkFkZHJlc3M+CgkJCQkJCTwhLS0gUiBbMS4uMV0g0JPQu9C+0LHQsNC70YzQvdGL0Lkg0YPQvdC40LrQsNC70YzQvdGL0Lkg0LjQtNC10L3RgtC40YTQuNC60LDRgtC+0YAg0LDQtNGA0LXRgdC90L7Qs9C+INC+0LHRitC10LrRgtCwIC0tPgoJCQkJCQk8ZmlhczpBT0dVSUQ+MjM1MzhkZDEtZjk4ZC00ZWJiLThiMzEtN2M3YjhkYmUzYzMyPC9maWFzOkFPR1VJRD4KCQkJCQkJPCEtLSBbMS4uMV0g0JPQu9C+0LHQsNC70YzQvdGL0Lkg0YPQvdC40LrQsNC70YzQvdGL0Lkg0LjQtNC10L3RgtC40YTQuNC60LDRgtC+0YAg0LTQvtC80LAgLS0+CgkJCQkJCTxmaWFzOkhPVVNFR1VJRD4yOTY1YjUxNy1lODQ5LTRiZDAtOTAzOS0wNWZiNTY5MTUxOGM8L2ZpYXM6SE9VU0VHVUlEPgoJCQkJCTwvZmlhczpBZGRyZXNzPgoJCQkJPC9hZGRyPgoJCQk8L3JlcHJlc2VudGVkT3JnYW5pemF0aW9uPgoJCTwvYXNzaWduZWRFbnRpdHk+Cgk8L2xlZ2FsQXV0aGVudGljYXRvcj4KCTwhLS0gWzAuLjFdINCh0LLQtdC00LXQvdC40Y8g0L7QsSDQuNGB0YLQvtGH0L3QuNC60LUg0L7Qv9C70LDRgtGLIC0tPgoJCgk8IS0tIFswLi4xXSDQodCy0LXQtNC10L3QuNGPINC+INC90LDQv9GA0LDQstC40LLRiNC10Lwg0LvQuNGG0LUsINC90LDQv9GA0LDQstC40LLRiNC10Lkg0L7RgNCz0LDQvdC40LfQsNGG0LjQuCAtLT4KCQoJPCEtLSBbMC4uMV0g0KHQstC10LTQtdC90LjRjyDQviDQvdCw0L/RgNCw0LLQu9C10L3QuNC4IC0tPgoJPGluRnVsZmlsbG1lbnRPZj4KCQk8IS0tIFIgWzEuLjFdLS0+CgkJPG9yZGVyPgoJCQk8IS0tIFsxLi4xXSDQo9C90LjQutCw0LvRjNC90YvQuSDQuNC00LXQvdGC0LjRhNC40LrQsNGC0L7RgCDQvdCw0L/RgNCw0LLQu9C10L3QuNGPINCyINCc0JjQoSAtLT4KCQkJPGlkIHJvb3Q9IjEuMi42NDMuNS4xLjEzLjMuMjUuNzcuNTAuMTAwLjEuMS41MSIgZXh0ZW5zaW9uPSI2NTk0ODE1NDgiIC8+CgkJCTwhLS0gWzEuLjFdINCj0L3QuNC60LDQu9GM0L3Ri9C5INC40LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINC90LDQv9GA0LDQstC70LXQvdC40Y8g0LIg0KDQrdCc0JQgLS0+CgkJCTxpZCByb290PSIxLjIuNjQzLjUuMS4xMy4xMy4xNy4xLjEiIGV4dGVuc2lvbj0iMTc3Ljc3LjIzLjA1LjMxNDE1OTIwMCIgLz4KCQkJPCEtLSBSIFsxLi4xXSDQktC40LQg0LzQtdC00LjRhtC40L3RgdC60L7Qs9C+INC90LDQv9GA0LDQstC70LXQvdC40Y8gLS0+CgkJCTxjb2RlIGNvZGU9IjMiIGNvZGVTeXN0ZW09IjEuMi42NDMuNS4xLjEzLjEzLjExLjE1MjIiIGNvZGVTeXN0ZW1OYW1lPSLQktC40LTRiyDQvNC10LTQuNGG0LjQvdGB0LrQvtC5INC00L7QutGD0LzQtdC90YLQsNGG0LjQuCIgZGlzcGxheU5hbWU9ItCd0LDQv9GA0LDQstC70LXQvdC40LUg0L3QsCDQs9C+0YHQv9C40YLQsNC70LjQt9Cw0YbQuNGOLCDQstC+0YHRgdGC0LDQvdC+0LLQuNGC0LXQu9GM0L3QvtC1INC70LXRh9C10L3QuNC1LCDQvtCx0YHQu9C10LTQvtCy0LDQvdC40LUsINC60L7QvdGB0YPQu9GM0YLQsNGG0LjRjiIgY29kZVN5c3RlbVZlcnNpb249IjcuMTkiIC8+CgkJPC9vcmRlcj4KCTwvaW5GdWxmaWxsbWVudE9mPgoJPCEtLSBSIFsxLi4xXSDQodCy0LXQtNC10L3QuNGPINC+INC00L7QutGD0LzQtdC90YLQuNGA0YPQtdC80L7QvCDRgdC+0LHRi9GC0LjQuCAtLT4KCTxkb2N1bWVudGF0aW9uT2Y+CgkJPCEtLSBSIFsxLi4xXS0tPgoJCTxzZXJ2aWNlRXZlbnQ+CgkJCTwhLS0gUiBbMS4uMV0g0KLQuNC/INC00L7QutGD0LzQtdC90YLQuNGA0YPQtdC80L7Qs9C+INGB0L7QsdGL0YLQuNGPIC0tPgoJCQk8Y29kZSBjb2RlPSIxIiBjb2RlU3lzdGVtPSIxLjIuNjQzLjUuMS4xMy4xMy45OS4yLjcyNiIgY29kZVN5c3RlbU5hbWU9ItCi0LjQv9GLINC00L7QutGD0LzQtdC90YLQuNGA0L7QstCw0L3QvdGL0YUg0YHQvtCx0YvRgtC40LkiIGRpc3BsYXlOYW1lPSLQmtC+0L3RgdGD0LvRjNGC0LDRhtC40Y8iIGNvZGVTeXN0ZW1WZXJzaW9uPSIzLjMxIiAvPgoJCQk8IS0tIFIgWzEuLjFdINCU0LDRgtGLINC00L7QutGD0LzQtdC90YLQuNGA0YPQtdC80L7Qs9C+INGB0L7QsdGL0YLQuNGPIC0tPgoJCQk8ZWZmZWN0aXZlVGltZT4KCQkJCTwhLS0gUiBbMS4uMV0g0JTQsNGC0LAg0L3QsNGH0LDQu9CwINC60L7QvdGB0YPQu9GM0YLQsNGG0LjQuCAtLT4KCQkJCTxsb3cgdmFsdWU9IjIwMjUxMTI0MTAzMCswMzAwIiAvPgoJCQkJPCEtLSBbMS4uMV0g0JTQsNGC0LAg0L7QutC+0L3Rh9Cw0L3QuNGPINC60L7QvdGB0YPQu9GM0YLQsNGG0LjQuCAtLT4KCQkJCTxoaWdoIHZhbHVlPSIyMDI1MTEyNDExMzArMDMwMCIgLz4KCQkJPC9lZmZlY3RpdmVUaW1lPgoJCQk8IS0tIFswLi4xXSDQpNC+0YDQvNCwINC+0LrQsNC30LDQvdC40Y8g0LzQtdC00LjRhtC40L3RgdC60L7QuSDQv9C+0LzQvtGJ0LggLS0+CgkJCTxtZWRTZXJ2aWNlOnNlcnZpY2VGb3JtIGNvZGU9IjEiIGNvZGVTeXN0ZW09IjEuMi42NDMuNS4xLjEzLjEzLjExLjE1NTEiIGNvZGVTeXN0ZW1OYW1lPSLQpNC+0YDQvNGLINC+0LrQsNC30LDQvdC40Y8g0LzQtdC00LjRhtC40L3RgdC60L7QuSDQv9C+0LzQvtGJ0LgiIGRpc3BsYXlOYW1lPSLQv9C70LDQvdC+0LLQsNGPIiBjb2RlU3lzdGVtVmVyc2lvbj0iMS4xIiAvPgoJCQk8IS0tIFswLi4xXSDQktC40LQg0LzQtdC00LjRhtC40L3RgdC60L7QuSDQv9C+0LzQvtGJ0LggLS0+CgkJCTxtZWRTZXJ2aWNlOnNlcnZpY2VUeXBlIGNvZGU9IjIiIGNvZGVTeXN0ZW09IjEuMi42NDMuNS4xLjEzLjEzLjExLjEwMzQiIGNvZGVTeXN0ZW1OYW1lPSLQktC40LTRiyDQvNC10LTQuNGG0LjQvdGB0LrQvtC5INC/0L7QvNC+0YnQuCIgZGlzcGxheU5hbWU9ItCf0LXRgNCy0LjRh9C90LDRjyDQstGA0LDRh9C10LHQvdCw0Y8g0LzQtdC00LjQutC+LdGB0LDQvdC40YLQsNGA0L3QsNGPINC/0L7QvNC+0YnRjCIgY29kZVN5c3RlbVZlcnNpb249IjQuMiIgLz4KCQkJPCEtLSBbMC4uMV0g0KPRgdC70L7QstC40Y8g0L7QutCw0LfQsNC90LjRjyDQvNC10LTQuNGG0LjQvdGB0LrQvtC5INC/0L7QvNC+0YnQuCAtLT4KCQkJPG1lZFNlcnZpY2U6c2VydmljZUNvbmQgY29kZT0iMiIgY29kZVN5c3RlbT0iMS4yLjY0My41LjEuMTMuMTMuOTkuMi4zMjIiIGNvZGVTeXN0ZW1OYW1lPSLQo9GB0LvQvtCy0LjRjyDQvtC60LDQt9Cw0L3QuNGPINC80LXQtNC40YbQuNC90YHQutC+0Lkg0L/QvtC80L7RidC4IiBkaXNwbGF5TmFtZT0i0JDQvNCx0YPQu9Cw0YLQvtGA0L3Qviwg0LIg0YLQvtC8INGH0LjRgdC70LUg0L3QsCDQtNC+0LzRgyDQv9GA0Lgg0LLRi9C30L7QstC1INC80LXQtNC40YbQuNC90YHQutC+0LPQviDRgNCw0LHQvtGC0L3QuNC60LAiIGNvZGVTeXN0ZW1WZXJzaW9uPSIyLjEiIC8+CgkJCTwhLS0gWzAuLipdINCh0LLQtdC00LXQvdC40Y8g0L7QsSDRg9GH0LDRgdGC0L3QuNC60LUg0LTQvtC60YPQvNC10L3RgtC40YDRg9C10LzQvtCz0L4g0YHQvtCx0YvRgtC40Y8gLS0+CgkJCTxwZXJmb3JtZXIgdHlwZUNvZGU9IlBQUkYiPgoJCQkJPCEtLSBSIFsxLi4xXS0tPgoJCQkJPGFzc2lnbmVkRW50aXR5PgoJCQkJCTwhLS0gWzEuLjFdINCj0L3QuNC60LDQu9GM0L3Ri9C5INC40LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINGD0YfQsNGB0YLQvdC40LrQsCDQtNC+0LrRg9C80LXQvdGC0LjRgNGD0LXQvNC+0LPQviDRgdC+0LHRi9GC0LjRjyDQsiDQnNCY0KEgLS0+CgkJCQkJPGlkIHJvb3Q9IjEuMi42NDMuNS4xLjEzLjEzLjEyLjIuNzcuNzgzMS4xMDAuMS4xLjcwIiBleHRlbnNpb249IjU0MjE3NCIgLz4KCQkJCQk8IS0tIFIgWzEuLjFdINCa0L7QtCDQtNC+0LvQttC90L7RgdGC0Lgg0YPRh9Cw0YHRgtC90LjQutCwINC00L7QutGD0LzQtdC90YLQuNGA0YPQtdC80L7Qs9C+INGB0L7QsdGL0YLQuNGPIC0tPgoJCQkJCTxjb2RlIGNvZGU9IjM0IiBjb2RlU3lzdGVtPSIxLjIuNjQzLjUuMS4xMy4xMy4xMS4xMDAyIiBjb2RlU3lzdGVtTmFtZT0i0JTQvtC70LbQvdC+0YHRgtC4INC80LXQtNC40YbQuNC90YHQutC40YUg0Lgg0YTQsNGA0LzQsNGG0LXQstGC0LjRh9C10YHQutC40YUg0YDQsNCx0L7RgtC90LjQutC+0LIiIGRpc3BsYXlOYW1lPSLQktGA0LDRhy3QutCw0YDQtNC40L7Qu9C+0LMiIGNvZGVTeXN0ZW1WZXJzaW9uPSI5LjMiIC8+CgkJCQkJPCEtLSBbMC4uKl0g0JrQvtC90YLQsNC60YLRiyDRg9GH0LDRgdGC0L3QuNC60LAg0LTQvtC60YPQvNC10L3RgtC40YDRg9C10LzQvtCz0L4g0YHQvtCx0YvRgtC40Y8gLS0+CgkJCQkJPHRlbGVjb20gdmFsdWU9InRlbDorNzQ5NTc0NDMyNTYiIHVzZT0iV1AiIC8+CgkJCQkJPCEtLSBSIFsxLi4xXS0tPgoJCQkJCTxhc3NpZ25lZFBlcnNvbj4KCQkJCQkJPCEtLSBSIFsxLi4xXSDQpNCY0J4g0YPRh9Cw0YHRgtC90LjQutCwINC00L7QutGD0LzQtdC90YLQuNGA0YPQtdC80L7Qs9C+INGB0L7QsdGL0YLQuNGPIC0tPgoJCQkJCQk8bmFtZT4KCQkJCQkJCTwhLS0gUiBbMS4uMV0g0KTQsNC80LjQu9C40Y8gLS0+CgkJCQkJCQk8ZmFtaWx5PmRvY3RvcjwvZmFtaWx5PgoJCQkJCQkJPCEtLSBSIFsxLi4xXSDQmNC80Y8gLS0+CgkJCQkJCQk8Z2l2ZW4+c2FoaWw8L2dpdmVuPgoJCQkJCQkJPCEtLSBbMC4uMV0g0J7RgtGH0LXRgdGC0LLQviAtLT4KCQkJCQkJCTxpZGVudGl0eTpQYXRyb255bWljPmFkbWluPC9pZGVudGl0eTpQYXRyb255bWljPgoJCQkJCQk8L25hbWU+CgkJCQkJPC9hc3NpZ25lZFBlcnNvbj4KCQkJCQk8IS0tIFswLi4xXSDQodCy0LXQtNC10L3QuNGPINC+0LEg0L7RgNCz0LDQvdC40LfQsNGG0LjQuCwg0LPQtNC1INGA0LDQsdC+0YLQsNC10YIg0YPRh9Cw0YHRgtC90LjQuiDQtNC+0LrRg9C80LXQvdGC0LjRgNGD0LXQvNC+0LPQviDRgdC+0LHRi9GC0LjRjyAtLT4KCQkJCQk8cmVwcmVzZW50ZWRPcmdhbml6YXRpb24gY2xhc3NDb2RlPSJPUkciPgoJCQkJCQk8IS0tIFIgWzEuLjFdINCj0L3QuNC60LDQu9GM0L3Ri9C5INC40LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINC80LXQtNC40YbQuNC90YHQutC+0Lkg0L7RgNCz0LDQvdC40LfQsNGG0LjQuCDQuCAo0L/RgNC4INC90LDQu9C40YfQuNC4KSDRg9C90LjQutCw0LvRjNC90YvQuSDQuNC00LXQvdGC0LjRhNC40LrQsNGC0L7RgCDRgdGC0YDRg9C60YLRg9GA0L3QvtCz0L4g0L/QvtC00YDQsNC30LTQtdC70LXQvdC40Y8gLS0+CgkJCQkJCTxpZCByb290PSIxLjIuNjQzLjUuMS4xMy4xMy4xMi4yLjc3Ljc4MzEiIGV4dGVuc2lvbj0iMS4yLjY0My41LjEuMTMuMTMuMTIuMi43Ny43ODMxLjAuMTA3NTMxIiAvPgoJCQkJCQk8IS0tIFIgWzEuLjFdINCd0LDQuNC80LXQvdC+0LLQsNC90LjQtSDQvNC10LTQuNGG0LjQvdGB0LrQvtC5INC+0YDQs9Cw0L3QuNC30LDRhtC40Lgg0LjQu9C4INCk0JjQniDQmNCfIC0tPgoJCQkJCQk8bmFtZT4zOHRlc3Q8L25hbWU+CgkJCQkJCTwhLS0gWzAuLipdINCa0L7QvdGC0LDQutGC0Ysg0LzQtdC00LjRhtC40L3RgdC60L7QuSDQvtGA0LPQsNC90LjQt9Cw0YbQuNC4INC40LvQuCDQmNCfIC0tPgoJCQkJCQk8dGVsZWNvbSB1c2U9IldQIiB2YWx1ZT0idGVsOis3ODAwNTUwMDg5NnRlc3QiIC8+CgkJCQkJCTwhLS0gWzAuLjFdINCQ0LTRgNC10YEg0LzQtdC00LjRhtC40L3RgdC60L7QuSDQvtGA0LPQsNC90LjQt9Cw0YbQuNC4INC40LvQuCDQmNCfIC0tPgoJCQkJCQk8YWRkcj4KCQkJCQkJCTwhLS0gUiBbMS4uMV0g0JDQtNGA0LXRgSAo0YLQtdC60YHRgtC+0LwpIC0tPgoJCQkJCQkJPHN0cmVldEFkZHJlc3NMaW5lPtCc0L7RgdC60LLQsCwgUnVzc2lhdGVzdDwvc3RyZWV0QWRkcmVzc0xpbmU+CgkJCQkJCQk8IS0tIFIgWzEuLjFdINCa0L7QtCDRgdGD0LHRitC10LrRgtCwINCg0KQgLS0+CgkJCQkJCQk8YWRkcmVzczpzdGF0ZUNvZGUgY29kZT0iNjgiIGNvZGVTeXN0ZW09IjEuMi42NDMuNS4xLjEzLjEzLjk5LjIuMjA2IiBjb2RlU3lzdGVtTmFtZT0i0KHRg9Cx0YrQtdC60YLRiyDQoNC+0YHRgdC40LnRgdC60L7QuSDQpNC10LTQtdGA0LDRhtC40LgiIGRpc3BsYXlOYW1lPSLQsy4g0JzQvtGB0LrQstCwIiBjb2RlU3lzdGVtVmVyc2lvbj0iNi41IiAvPgoJCQkJCQkJPCEtLSBbMS4uMV0g0J/QvtGH0YLQvtCy0YvQuSDQuNC90LTQtdC60YEgLS0+CgkJCQkJCQk8cG9zdGFsQ29kZT50ZXN0IHBvc3RhbGNvZGUzOHRlc3Q8L3Bvc3RhbENvZGU+CgkJCQkJCQk8IS0tIFsxLi4xXSDQmNC00LXQvdGC0LjRhNC40LrQsNGC0L7RgCDQsNC00YDQtdGB0LAg0L/QviDQpNCY0JDQoSAtLT4KCQkJCQkJCTxmaWFzOkFkZHJlc3M+CgkJCQkJCQkJPCEtLSBSIFsxLi4xXSDQk9C70L7QsdCw0LvRjNC90YvQuSDRg9C90LjQutCw0LvRjNC90YvQuSDQuNC00LXQvdGC0LjRhNC40LrQsNGC0L7RgCDQsNC00YDQtdGB0L3QvtCz0L4g0L7QsdGK0LXQutGC0LAgLS0+CgkJCQkJCQkJPGZpYXM6QU9HVUlEPjc5Y2NlMWVhLTlhNGQtNGNmMy1iM2Q0LTQ0ODE0MjY2NzM5ODwvZmlhczpBT0dVSUQ+CgkJCQkJCQkJPCEtLSBbMS4uMV0g0JPQu9C+0LHQsNC70YzQvdGL0Lkg0YPQvdC40LrQsNC70YzQvdGL0Lkg0LjQtNC10L3RgtC40YTQuNC60LDRgtC+0YAg0LTQvtC80LAgLS0+CgkJCQkJCQkJPGZpYXM6SE9VU0VHVUlEPjQxMWIzYzUxLWNhZDgtNDE4NS05YzViLTdhM2EzNGEyNWE0NjwvZmlhczpIT1VTRUdVSUQ+CgkJCQkJCQk8L2ZpYXM6QWRkcmVzcz4KCQkJCQkJPC9hZGRyPgoJCQkJCTwvcmVwcmVzZW50ZWRPcmdhbml6YXRpb24+CgkJCQk8L2Fzc2lnbmVkRW50aXR5PgoJCQk8L3BlcmZvcm1lcj4KCQkJPCEtLSBbMC4uKl0g0KHQstC10LTQtdC90LjRjyDQvtCxINGD0YfQsNGB0YLQvdC40LrQtSDQtNC+0LrRg9C80LXQvdGC0LjRgNGD0LXQvNC+0LPQviDRgdC+0LHRi9GC0LjRjyAtLT4KCQkJCgkJPC9zZXJ2aWNlRXZlbnQ+Cgk8L2RvY3VtZW50YXRpb25PZj4KCTwhLS0gWzAuLjFdINCh0LLQtdC00LXQvdC40Y8g0L4g0YHQu9GD0YfQsNC1INC+0LrQsNC30LDQvdC40Y8g0LzQtdC00LjRhtC40L3RgdC60L7QuSDQv9C+0LzQvtGJ0LggLS0+Cgk8Y29tcG9uZW50T2Y+CgkJPCEtLSBSIFsxLi4xXS0tPgoJCTxlbmNvbXBhc3NpbmdFbmNvdW50ZXI+CgkJCTwhLS0gUiBbMS4uMV0g0KPQvdC40LrQsNC70YzQvdGL0Lkg0LjQtNC10L3RgtC40YTQuNC60LDRgtC+0YAg0YHQu9GD0YfQsNGPINC+0LrQsNC30LDQvdC40Y8g0LzQtdC00LjRhtC40L3RgdC60L7QuSDQv9C+0LzQvtGJ0Lgg0LIg0JzQmNChIC0tPgoJCQk8aWQgcm9vdD0iMS4yLjY0My41LjEuMTMuMTMuMTIuMi43Ny43ODMxLjEwMC4xLjEuMTUiIGV4dGVuc2lvbj0iNTQ2OS0xNiIgLz4KCQkJPCEtLSBbMC4uMV0g0KPQvdC40LrQsNC70YzQvdGL0Lkg0LjQtNC10L3RgtC40YTQuNC60LDRgtC+0YAg0YHQu9GD0YfQsNGPINC+0LrQsNC30LDQvdC40Y8g0LzQtdC00LjRhtC40L3RgdC60L7QuSDQv9C+0LzQvtGJ0LggKNC90L7QvNC10YAg0LjRgdGC0L7RgNC40Lgg0LHQvtC70LXQt9C90LgsINCw0LzQsdGD0LvQsNGC0L7RgNC90L7QuSDQutCw0YDRgtGLKSAtLT4KCQkJPGlkIHJvb3Q9IjEuMi42NDMuNS4xLjEzLjEzLjEyLjIuNzcuNzgzMS4xMDAuMS4xLjE3IiBleHRlbnNpb249IjU0OTktMTYiIC8+CgkJCTwhLS0gWzAuLjFdINCi0LjQvyDQvNC10LTQuNGG0LjQvdGB0LrQvtC5INC60LDRgNGC0YsgLS0+CgkJCTxjb2RlIGNvZGU9IjEiIGNvZGVTeXN0ZW09IjEuMi42NDMuNS4xLjEzLjEzLjk5LjIuNzIzIiBjb2RlU3lzdGVtTmFtZT0i0KLQuNC/0Ysg0LzQtdC00LjRhtC40L3RgdC60LjRhSDQutCw0YDRgiIgZGlzcGxheU5hbWU9ItCQ0LzQsdGD0LvQsNGC0L7RgNC90LDRjyDQvNC10LTQuNGG0LjQvdGB0LrQsNGPINC60LDRgNGC0LAiIGNvZGVTeXN0ZW1WZXJzaW9uPSIxLjEiIC8+CgkJCTwhLS0gWzAuLjFdINCS0LjQtCDQvNC10LTQuNGG0LjQvdGB0LrQvtC5INC60LDRgNGC0YsgLS0+CgkJCTwhLS0gWzAuLjFdINCU0LDRgtGLINGB0LvRg9GH0LDRjyAtLT4KCQkJPGVmZmVjdGl2ZVRpbWU+CgkJCQk8IS0tIFIgWzEuLjFdINCU0LDRgtCwINC90LDRh9Cw0LvQsCDRgdC70YPRh9Cw0Y8gLS0+CgkJCQk8bG93IHZhbHVlPSIyMDIzMDUwMjE1MzArMDMwMCIgLz4KCQkJCTwhLS0gWzAuLjFdINCU0LDRgtCwINC+0LrQvtC90YfQsNC90LjRjyDRgdC70YPRh9Cw0Y8gLS0+CgkJCQk8aGlnaCB2YWx1ZT0iMjAyMzA1MDIxNTQ1KzAzMDAiIC8+CgkJCTwvZWZmZWN0aXZlVGltZT4KCQk8L2VuY29tcGFzc2luZ0VuY291bnRlcj4KCTwvY29tcG9uZW50T2Y+Cgk8IS0tIFIgWzEuLjFdINCi0LXQu9C+INC00L7QutGD0LzQtdC90YLQsCAtLT4KCTxjb21wb25lbnQ+CgkJPCEtLSBSIFsxLi4xXSDQodGC0YDRg9C60YLRg9GA0LjRgNC+0LLQsNC90L3QvtC1INGC0LXQu9C+INC00L7QutGD0LzQtdC90YLQsCAtLT4KCQk8c3RydWN0dXJlZEJvZHk+CgkJCTwhLS0gUiBbMS4uMV0g0KHQldCa0KbQmNCvOiAi0KHQstC10LTQtdC90LjRjyDQviDQtNC+0LrRg9C80LXQvdGC0LUiICgi0KHQstC10LTQtdC90LjRjyDQviDQutC+0L3RgdGD0LvRjNGC0LDRhtC40LgiKS0tPgoJCQkKCQkJPCEtLSBbMC4uMV0g0KHQldCa0KbQmNCvOiAi0JvRjNCz0L7RgtGLIiAtLT4KCQkJCgkJCTwhLS0gWzAuLjFdINCh0JXQmtCm0JjQrzogItCW0LDQu9C+0LHRiyIgLS0+CgkJCQoJCQk8IS0tIFIgWzEuLjFdINCh0JXQmtCm0JjQrzogItCQ0L3QsNC80L3QtdC3INC30LDQsdC+0LvQtdCy0LDQvdC40Y8iIC0tPgoJCQkKCQkJPCEtLSBSIFsxLi4xXSDQodCV0JrQptCY0K86ICLQkNC90LDQvNC90LXQtyDQttC40LfQvdC4IiAtLT4KCQkJCgkJCTwhLS0gWzAuLjFdINCh0JXQmtCm0JjQrzogItCg0LXQt9GD0LvRjNGC0LDRgtGLINC60L7QvdGB0YPQu9GM0YLQsNGG0LjQuC/QvtGB0LzQvtGC0YDQsCDQstGA0LDRh9CwIiAtLT4KCQkJCgkJCTwhLS0gWzAuLjFdINCh0JXQmtCm0JjQrzogItCg0LXRiNC10L3QuNC1INC60L7QvdGB0LjQu9C40YPQvNCwIiAtLT4KCQkJPCEtLSBbMC4uMV0g0KHQldCa0KbQmNCvOiAi0KDQtdGI0LXQvdC40LUg0LLRgNCw0YfQtdCx0L3QvtC5INC60L7QvNC40YHRgdC40LgiIC0tPgoJCQk8IS0tIFswLi4xXSDQodCV0JrQptCY0K86ICLQoNC10LfRg9C70YzRgtCw0YLRiyDQuNC90YHRgtGA0YPQvNC10L3RgtCw0LvRjNC90L7Qs9C+INC40YHRgdC70LXQtNC+0LLQsNC90LjRjyIgLS0+CgkJCQoJCQk8IS0tIFswLi4xXSDQodCV0JrQptCY0K86ICLQoNC10LfRg9C70YzRgtCw0YLRiyDQu9Cw0LHQvtGA0LDRgtC+0YDQvdC+0LPQviDQuNGB0YHQu9C10LTQvtCy0LDQvdC40Y8iIC0tPgoJCQkKCQkJPCEtLSBbMC4uMV0g0KHQldCa0KbQmNCvOiAi0KDQtdC30YPQu9GM0YLQsNGC0Ysg0L/RgNC40LbQuNC30L3QtdC90L3QvtCz0L4g0L/QsNGC0L7Qu9C+0LPQvi3QsNC90LDRgtC+0LzQuNGH0LXRgdC60L7Qs9C+INC40YHRgdC70LXQtNC+0LLQsNC90LjRjyIgLS0+CgkJCTwhLS0gWzAuLjFdINCh0JXQmtCm0JjQrzogItCe0L/QtdGA0LDRgtC40LLQvdC+0LUg0LLQvNC10YjQsNGC0LXQu9GM0YHRgtCy0L4iIC0tPgoJCQk8IS0tIFswLi4xXSDQodCV0JrQptCY0K86ICLQn9GA0L7Rh9C40LUg0LzQtdC00LjRhtC40L3RgdC60LjQtSDQv9GA0L7RhtC10LTRg9GA0Ysg0Lgg0LzQsNC90LjQv9GD0LvRj9GG0LjQuCIgLS0+CgkJCTwhLS0gWzAuLjFdINCh0JXQmtCm0JjQrzogItCh0LLQtdC00LXQvdC40Y8g0L4g0YLRgNCw0L3RgdGE0YPQt9C40LgiIC0tPgoJCQk8IS0tIFswLi4xXSDQodCV0JrQptCY0K86ICLQnNC10LTQuNC60LDQvNC10L3RgtC+0LfQvdC+0LUg0LvQtdGH0LXQvdC40LUiIC0tPgoJCQkKCQkJPCEtLSBbMC4uMV0g0KHQldCa0KbQmNCvOiAi0JLQuNGC0LDQu9GM0L3Ri9C1INC/0LDRgNCw0LzQtdGC0YDRiyIgLS0+CgkJCQoJCQk8IS0tIFswLi4xXSDQodCV0JrQptCY0K86ICLQntCx0YrQtdC60YLQuNCy0LjQt9C40YDQvtCy0LDQvdC90LDRjyDQvtGG0LXQvdC60LAg0YHQvtGB0YLQvtGP0L3QuNGPINC/0LDRhtC40LXQvdGC0LAiIC0tPgoJCQkKCQkJPCEtLSBSIFsxLi4xXSDQodCV0JrQptCY0K86ICLQlNC40LDQs9C90L7Qt9GLIiAtLT4KCQkJCgkJCTwhLS0gWzAuLjFdINCh0JXQmtCm0JjQrzogItCg0LXQttC40Lwg0Lgg0YDQtdC60L7QvNC10L3QtNCw0YbQuNC4IiAtLT4KCQkJCgkJCTwhLS0gWzAuLjFdINCh0JXQmtCm0JjQrzogItCe0LrQsNC30LDQvdC90YvQtSDRg9GB0LvRg9Cz0LgiIC0tPgoJCQkKCQkJPCEtLSBbMC4uMV0g0KHQldCa0KbQmNCvOiAi0KHQstGP0LfQsNC90L3Ri9C1INC00L7QutGD0LzQtdC90YLRiyIgLS0+CgkJCQoJCTwvc3RydWN0dXJlZEJvZHk+Cgk8L2NvbXBvbmVudD4KPC9DbGluaWNhbERvY3VtZW50Pg==");

                if (xmlBytes.Length < 500)
                    return new BaseResponse(HttpStatusCode.BadRequest, ExceptionStatus.error,
                        $"Invalid CDA DataBase64: too small ({xmlBytes.Length} bytes).");

                string bothSigns = "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";
                var orgSignBytes = Convert.FromBase64String(bothSigns);
                var signBytes = Convert.FromBase64String(bothSigns);
               
                var laboratoryReport = new MedDocument
                {
                    IdMedDocumentType = 316,
                    Attachments = [
                    new MedDocumentDtoDocumentAttachment
                    {
                        Data = xmlBytes,
                        OrganizationSign = orgSignBytes,
                        MimeType = "text/xml",
                        PersonalSigns = [
                            new MedDocumentDtoPersonalSign
                            {
                                Sign = signBytes,
                                Doctor = new ()
                                {
                                    Person = new ()
                                    {
                                        HumanName = new()
                                        {
                                            GivenName = dto.DoctorPerson.GivenName,
                                            MiddleName = dto.DoctorPerson.MiddleName,
                                            FamilyName = dto.DoctorPerson.FamilyName
                                        },
                                        Sex = (byte)dto.DoctorPerson.Sex,
                                        Birthdate = dto.DoctorPerson.Birthdate,
                                        IdPersonMis = dto.DoctorPerson.IdPersonMis,
                                        Documents = dto.DoctorPerson.Documents.Select(d => new IdentityDocument()
                                        {
                                            DocN = d.DocN,
                                            DocS = d.DocS,
                                            DocumentName = d.DocumentName,
                                            ExpiredDate = d.ExpiredDate,
                                            IdDocumentType = (byte)d.IdDocumentType,
                                            IdProvider = (int)d.IdProvider,
                                            IssuedDate = d.IssuedDate,
                                            ProviderName = d.ProviderName,
                                            RegionCode = d.RegionCode,
                                            StartDate = d.StartDate
                                        }).ToArray()
                                    },
                                    IdLpu = null,
                                    IdSpeciality = (ushort)N3Enums.N3IdSpeciality.Geriatrics,
                                    IdPosition = (ushort)N3Enums.N3IdPosition.HeadOfKennel
                                }
                            }
                        ]
                    }
                    ],
                    Author = new()
                    {
                        Person = new()
                        {
                            HumanName = new()
                            {
                                GivenName = dto.AuthorPerson.GivenName,
                                MiddleName = dto.AuthorPerson.MiddleName,
                                FamilyName = dto.AuthorPerson.FamilyName
                            },
                            Sex = (byte)dto.AuthorPerson.Sex,
                            Birthdate = dto.AuthorPerson.Birthdate,
                            IdPersonMis = dto.AuthorPerson.IdPersonMis,
                            Documents = dto.AuthorPerson.Documents.Select(d => new IdentityDocument()
                            {
                                DocN = d.DocN,
                                DocS = d.DocS,
                                DocumentName = d.DocumentName,
                                ExpiredDate = d.ExpiredDate,
                                IdDocumentType = (byte)d.IdDocumentType,
                                IdProvider = (int)d.IdProvider,
                                IssuedDate = d.IssuedDate,
                                ProviderName = d.ProviderName,
                                RegionCode = d.RegionCode,
                                StartDate = d.StartDate
                            }).ToArray()
                        },
                        IdLpu = null,
                        IdPosition = (ushort)N3Enums.N3IdPosition.HeadOfKennel
                    },
                    CreationDate = DateTime.Now,
                    Header = dto.Header,
                    IdDocumentMis = dto.IdDocumentMis,
                };

                await emkClient.AddMedRecordAsync(dto.ProjectGuid, dto.Idlpu, dto.PatientGlobalId, null, laboratoryReport, null);

                return new BaseResponse(HttpStatusCode.OK);
            }
            catch (Exception ex)
            {
                return new BaseResponse(HttpStatusCode.BadRequest, ExceptionStatus.error, ex.Message);
            }
        }

        public async Task<BaseResponse> UpdateMedRecord()
        {
            byte[] data = Convert.FromBase64String("");
            byte[] organizationSIgn = Convert.FromBase64String("");
            byte[] sign = Convert.FromBase64String("");
            MedDocument medDocument = new()
            {
                Attachments = [
                            new MedDocumentDtoDocumentAttachment()
                            {
                            Data = data,
                            OrganizationSign = organizationSIgn,
                            PersonalSigns = [
                                    new(){
                                        Sign = sign,
                                        Doctor = new(){
                                            Person = new(){
                                                HumanName = new(){
                                                    GivenName = "sako",
                                                    MiddleName = "null",
                                                    FamilyName = "sako"
                                                },
                                                IdPersonMis = "415",
                                                Documents = [
                                                    new IdentityDocument(){
                                                        DocN = "52293671595",
                                                        DocS = "321312",
                                                        DocumentName = "СНИЛС",
                                                        ExpiredDate = new DateTime(2011, 12, 1),
                                                        IdDocumentType = (byte)N3Enums.N3IdDocumentType.PensionInsuranceCertificate,
                                                        IdProvider = null,
                                                        IssuedDate = new DateTime(2008, 9, 3),
                                                        ProviderName = "ПФР",
                                                        RegionCode = "128",
                                                        StartDate = new DateTime(2008, 9, 4)
                                                    },
                                                    new IdentityDocument()
                                                    {
                                                        DocN = "8769227022",
                                                        DocS = "365431",
                                                        DocumentName = "ДМС",
                                                        ExpiredDate = new DateTime(2010, 12, 1),
                                                        IdDocumentType = (byte)N3Enums.N3IdDocumentType.RussianCitizenPassport,
                                                        IdProvider = 59021,
                                                        IssuedDate = new DateTime(2006, 9, 3),
                                                        ProviderName = "ДМС",
                                                        RegionCode = "128",
                                                        StartDate = new DateTime(2006, 9, 4)
                                                    },
                                                    ]
                                            },
                                            IdSpeciality =28,
                                            IdPosition = 114
                                        },
                                    }
                                ],
                            MimeType = "application/pdf"
                            }
                    ],
                Author = new()
                {
                    Person = new()
                    {
                        HumanName = new()
                        {
                            GivenName = "saksocu",
                            MiddleName = "sako",
                            FamilyName = "sak"
                        },
                        IdPersonMis = "415",
                        Documents = [
                                new(){
                                    DocN ="25857824124",
                                    DocS = "111112",
                                    DocumentName = "СНИЛС",
                                    ExpiredDate = new(2011,12,1),
                                    IdDocumentType =(byte)N3Enums.N3IdDocumentType.PensionInsuranceCertificate,
                                    IdProvider = null,
                                    IssuedDate = new(2008,9,3),
                                    ProviderName = "ПФР",
                                    RegionCode = "128",
                                    StartDate = new(2008,9,4)
                                }
                            ]
                    },
                    IdSpeciality = 28,
                    IdPosition = 114
                },
                CreationDate = DateTime.Now,
                Header = "Лабораторные исследования",
                IdDocumentMis = "iddocmed332axxz",
                IdMedDocumentType = 2
            };

            await emkClient.UpdateMedRecordAsync(projectGuid, idLPU, "patient5ssq", null, medDocument, null);
            return new BaseResponse(HttpStatusCode.OK); ;
        }


        private static void ValidateBase64OrThrow(string value, string fieldName)
        {
            if (string.IsNullOrWhiteSpace(value))
                throw new Exception($"{fieldName} is empty");

            var s = value.Trim();

            // quick character scan
            for (int i = 0; i < s.Length; i++)
            {
                char ch = s[i];
                bool ok =
                    (ch >= 'A' && ch <= 'Z') ||
                    (ch >= 'a' && ch <= 'z') ||
                    (ch >= '0' && ch <= '9') ||
                    ch == '+' || ch == '/' || ch == '=' ||
                    ch == '\r' || ch == '\n' || ch == ' ' || ch == '\t' ||
                    ch == '-' || ch == '_'; // allow base64url for now

                if (!ok)
                    throw new Exception($"{fieldName} has illegal char '{ch}' at index {i}");
            }

            // now try tolerant decode
            _ = DecodeBase64Tolerant(s);
        }

        private static byte[] DecodeBase64Tolerant(string s)
        {
            s = s.Replace("\r", "")
                 .Replace("\n", "")
                 .Replace(" ", "")
                 .Replace("\t", "");

            // base64url -> base64
            s = s.Replace('-', '+').Replace('_', '/');

            // padding fix
            int mod = s.Length % 4;
            if (mod != 0)
                s += new string('=', 4 - mod);

            return Convert.FromBase64String(s);
        }
        static byte[] DecodeBase64Strict(string? s, string field)
        {
            if (string.IsNullOrWhiteSpace(s))
                throw new Exception($"{field} is empty");

            try
            {
                var bytes = Convert.FromBase64String(s);
                if (bytes.Length == 0)
                    throw new Exception($"{field} decoded to empty bytes");
                return bytes;
            }
            catch (FormatException)
            {
                throw new Exception($"{field} is not valid Base64");
            }
        }

    }

}
